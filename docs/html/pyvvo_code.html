
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyVVO Code &#8212; PyVVO  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Building the PyVVO Documentation" href="build_docs.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pyvvo-code">
<h1>PyVVO Code<a class="headerlink" href="#pyvvo-code" title="Permalink to this headline">¶</a></h1>
<p>This section contains automatically generated documentation of the
PyVVO source code.</p>
<div class="section" id="module-pyvvo">
<span id="pyvvo"></span><h2>pyvvo<a class="headerlink" href="#module-pyvvo" title="Permalink to this headline">¶</a></h2>
<p>PyVVO is a Volt-VAR optimization (VVO) application for GridAPPS-D.</p>
<p>Author: Brandon Thayer (Pacific Northwest National Laboratory)</p>
<p>It is completely “Dockerized,” and also dependent on the GridAPPS-D
platform itself.</p>
<p>In short, PyVVO pulls historic “smart meter” data in order to create
predictive, voltage-dependent load models. These load models are then
layered onto a feeder model (in GridLAB-D format). A genetic algorithm
then runs the feeder model with many different device configurations
to determine what control settings are best. At the moment, PyVVO only
controls regulators and capacitors (future work should include
distributed generation resources such a photovoltaic
inverters).</p>
<p>Many of PyVVO’s Python modules are likely very useful for other
GridAPPS-D applications. For instance, sparql.py contains many useful
queries for obtaining information from the CIM triple-store database,
gridappsd_platform.py provides objects for interfacing with the
GridAPPS-D platform itself, glm.py is useful for managing GridLAB-D
models, and zip.py has code for creating ZIP load models from
measurement data.</p>
<p>This file (__init__.py) does some application-wide logging
configuration. It uses log_config.json.</p>
</div>
<div class="section" id="module-pyvvo.app">
<span id="app-py"></span><h2>app.py<a class="headerlink" href="#module-pyvvo.app" title="Permalink to this headline">¶</a></h2>
<p>Main module for running the PyVVO application.</p>
<dl class="py class">
<dt id="pyvvo.app.GAStopper">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.app.</code><code class="sig-name descname">GAStopper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ga_obj</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyvvo.ga.GA" title="pyvvo.ga.GA">pyvvo.ga.GA</a></span></em>, <em class="sig-param"><span class="n">eq_mgr</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyvvo.equipment.EquipmentManager" title="pyvvo.equipment.EquipmentManager">pyvvo.equipment.EquipmentManager</a></span></em>, <em class="sig-param"><span class="n">eq_type</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.app.GAStopper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple class for stopping the genetic algorithm when a piece of
equipment changes state.</p>
<p>Register callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ga_obj</strong> – Initialized ga.GA object.</p></li>
<li><p><strong>eq_mgr</strong> – Initialized equipment.EquipmentManager.</p></li>
<li><p><strong>eq_type</strong> – String description of equipment type used for
logging. e.g. “switch”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.app.main">
<code class="sig-prename descclassname">pyvvo.app.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sim_id</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">sim_request</span><span class="p">:</span> <span class="n">dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.app.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for running the PyVVO application.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_id</strong> – ID of simulation PyVVO will interact with.</p></li>
<li><p><strong>sim_request</strong> – Simulation request details that were used to
start the simulation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.cluster">
<span id="cluster-py"></span><h2>cluster.py<a class="headerlink" href="#module-pyvvo.cluster" title="Permalink to this headline">¶</a></h2>
<p>Module for performing K-means clustering on data.</p>
<p>In the context of PyVVO, functions here are used before performing fits
to the ZIP load model (see zip.py).</p>
<dl class="py function">
<dt id="pyvvo.cluster.euclidean_distance_squared">
<code class="sig-prename descclassname">pyvvo.cluster.</code><code class="sig-name descname">euclidean_distance_squared</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v1</span></em>, <em class="sig-param"><span class="n">v2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.cluster.euclidean_distance_squared" title="Permalink to this definition">¶</a></dt>
<dd><p>Find squared Euclidean distance between two data sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> – 1st data set. Can be numpy array, pandas Series, or
pandas DataFrame. DataFrame is assumed to be simple 2-D
DataFrame without a MultiIndex.</p></li>
<li><p><strong>v2</strong> – 2nd data set. “…”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scalar value representing squared Euclidean distance
distance between the two data sets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.cluster.feature_scale">
<code class="sig-prename descclassname">pyvvo.cluster.</code><code class="sig-name descname">feature_scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">x_ref</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.cluster.feature_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform feature scaling: all data mapped to set [0, 1].</p>
<p>NOTE: DataFrames are feature scaled by column.</p>
<p>NOTE: If x_ref creates a column of NaNs or infs (x is DataFrame) or
the entire Series NaN or infs (x is Series), NaNs are zeroed out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Data to feature scale. pandas DataFrame or Series</p></li>
<li><p><strong>x_ref</strong> – Reference data to scale x to. None or pandas DataFrame</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>x_prime: feature scaled version of x</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.cluster.find_best_cluster">
<code class="sig-prename descclassname">pyvvo.cluster.</code><code class="sig-name descname">find_best_cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cluster_data</span></em>, <em class="sig-param"><span class="n">selection_data</span></em>, <em class="sig-param"><span class="n">n_clusters</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.cluster.find_best_cluster" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_data</strong> – pandas DataFrame containing data which will be
clustered via K-means. NOTE: data should be
normalized.</p></li>
<li><p><strong>selection_data</strong> – pandas Series containing data which will
be used to select the best cluster. NOTE:
data should be normalized in same fashion as
cluster_data.</p></li>
<li><p><strong>n_clusters</strong> – int, number of clusters to create.</p></li>
<li><p><strong>random_state</strong> – int, numpy random.RandomState object, or None.
Used to seed the KMeans object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.db">
<span id="db-py"></span><h2>db.py<a class="headerlink" href="#module-pyvvo.db" title="Permalink to this headline">¶</a></h2>
<p>Module for database related methods.</p>
<p>The following environment variables will be used for database
connections:</p>
<blockquote>
<div><p>DB_HOST: hostname of the MySQL database.
DB_USER: User to use to connect to MySQL.
DB_PASS: Password for DB_USER.
DB_DB: Database to use.
DB_PORT: Port to connect to MySQL.</p>
</div></blockquote>
<dl class="py function">
<dt id="pyvvo.db.connect_loop">
<code class="sig-prename descclassname">pyvvo.db.</code><code class="sig-name descname">connect_loop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">retry_interval</span><span class="o">=</span><span class="default_value">0.25</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.db.connect_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to connect to the database for a set amount of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> – Total time (seconds) to wait for the database.</p></li>
<li><p><strong>retry_interval</strong> – Time (seconds) between reconnection attempts.</p></li>
</ul>
</dd>
</dl>
<p>:return MySQLdb.connections.Connection object.</p>
<p>:raises MySQLdb.Error</p>
<p>Note that this method is primitive: It isn’t tracking the entire
function runtime, but rather sleeping for retry_interval in
between attempts. Thus, the maximum number of attempts is exactly
timeout / retry_interval.</p>
<p>Note:</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.db.db_env_defined">
<code class="sig-prename descclassname">pyvvo.db.</code><code class="sig-name descname">db_env_defined</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.db.db_env_defined" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to check if the necessary database-related environment
variables are all present.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.db.execute_and_fetch_all">
<code class="sig-prename descclassname">pyvvo.db.</code><code class="sig-name descname">execute_and_fetch_all</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">db_conn</span></em>, <em class="sig-param"><span class="n">query</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.db.execute_and_fetch_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple wrapper to execute a query and return all results.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.db.truncate_table">
<code class="sig-prename descclassname">pyvvo.db.</code><code class="sig-name descname">truncate_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">db_conn</span></em>, <em class="sig-param"><span class="n">table</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.db.truncate_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate a table if it exists.</p>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.equipment">
<span id="equipment-py"></span><h2>equipment.py<a class="headerlink" href="#module-pyvvo.equipment" title="Permalink to this headline">¶</a></h2>
<p>Module for classes which represent equipment. E.g. regulators,
capacitors, or switches.</p>
<dl class="py class">
<dt id="pyvvo.equipment.CapacitorSinglePhase">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">CapacitorSinglePhase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">mrid</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">mode</span></em>, <em class="sig-param"><span class="n">controllable</span></em>, <em class="sig-param"><span class="n">state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">operable</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.CapacitorSinglePhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.equipment.EquipmentSinglePhase" title="pyvvo.equipment.EquipmentSinglePhase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.equipment.EquipmentSinglePhase</span></code></a></p>
<p>Single phase capacitor.
Parameters will for the most part come straight out of the CIM.</p>
<p>TODO: Accept all CIM parameters.</p>
<p>Initialize single phase capacitor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mrid</strong> – MRID of this capacitor. In the CIM,
LinearShunCompensator.mRID.</p></li>
<li><p><strong>name</strong> – Name of this capacitor. In the CIM,
LinearShunCompensator.name.</p></li>
<li><p><strong>phase</strong> – Phase of this capacitor.</p></li>
<li><p><strong>mode</strong> – Control mode, must be one of MODES. In the CIM,
this is a RegulatingControl.RegulatingControlModeKind. Note
that if None, the capacitor is assumed to be uncontrollable.</p></li>
<li><p><strong>controllable</strong> – Boolean. Whether or not this capacitor is
controllable. If False, PyVVO will never attempt to send a
command to this capacitor.</p></li>
<li><p><strong>state</strong> – Integer, must be in STATES attribute. 0 indicates
open, 1 indicates closed.</p></li>
<li><p><strong>operable</strong> – Whether the capacitor is operable (working).
I.e., a controllable capacitor could be temporarily not
responding to commands, which would mean operable should be
False.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="pyvvo.equipment.CapacitorSinglePhase.MODES">
<code class="sig-name descname">MODES</code><em class="property"> = ('voltage', 'activepower', 'reactivepower', 'currentflow', 'admittance', 'timescheduled', 'temperature', 'powerfactor')</em><a class="headerlink" href="#pyvvo.equipment.CapacitorSinglePhase.MODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.CapacitorSinglePhase.STATES">
<code class="sig-name descname">STATES</code><em class="property"> = (0, 1)</em><a class="headerlink" href="#pyvvo.equipment.CapacitorSinglePhase.STATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.CapacitorSinglePhase.STATE_CIM_PROPERTY">
<code class="sig-name descname">STATE_CIM_PROPERTY</code><em class="property"> = 'ShuntCompensator.sections'</em><a class="headerlink" href="#pyvvo.equipment.CapacitorSinglePhase.STATE_CIM_PROPERTY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.CapacitorSinglePhase.mode">
<em class="property">property </em><code class="sig-name descname">mode</code><a class="headerlink" href="#pyvvo.equipment.CapacitorSinglePhase.mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Control mode.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.EquipmentManager">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">EquipmentManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_dict</span></em>, <em class="sig-param"><span class="n">eq_meas</span></em>, <em class="sig-param"><span class="n">meas_mrid_col</span></em>, <em class="sig-param"><span class="n">eq_mrid_col</span></em>, <em class="sig-param"><span class="n">eq_type</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.EquipmentManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to keep EquipmentSinglePhase objects up to date as a
simulation proceeds. E.g. capacitors or regulators.</p>
<p>This is meant to be used in conjunction with a SimOutRouter from
gridappsd_platform.py, which will route relevant simulation output
to the “update_state” method.</p>
<p>One can add callback functions via the “add_callback” method. These
will be called if any equipment changes state.</p>
<p>Initialize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_dict</strong> – Dictionary of EquipmentSinglePhase objects
as returned by regulator.initialize_regulators
or capacitor.initialize_capacitors.</p></li>
<li><p><strong>eq_meas</strong> – Pandas DataFrame as returned by
sparql.SPARQLManager’s query_rtc_measurements method, or
sparql.SPARQLManager’s query query_capacitor_measurements
method.</p></li>
<li><p><strong>meas_mrid_col</strong> – String. Column in eq_meas corresponding
to measurement MRIDs in the eq_meas DataFrame.</p></li>
<li><p><strong>eq_mrid_col</strong> – String. Column in eq_meas corresponding to
the equipment MRIDs in the eq_meas DataFrame.</p></li>
<li><p><strong>eq_type</strong> – String representing equipment type, used for
logging. E.g. “Regulator” or “Inverter”</p></li>
</ul>
</dd>
</dl>
<p>The eq_dict and eq_meas must have the same number of elements.</p>
<dl class="py method">
<dt id="pyvvo.equipment.EquipmentManager.add_callback">
<code class="sig-name descname">add_callback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">callback</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>datetime.datetime<span class="p">]</span><span class="p">, </span>Any<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.EquipmentManager.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a callback which will be called when equipment changes
state via the update_state method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callback</strong> – Function to call when equipment changes state
via the update_state method. The callback should take a
single datetime.datetime parameter, which represents
simulation time when the state change occurred.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentManager.build_equipment_commands">
<code class="sig-name descname">build_equipment_commands</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.EquipmentManager.build_equipment_commands" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to build command for changing equipment state. The
command itself should be sent with a
gridappsd_platform.PlatformManager object’s send_command method.</p>
<p>This object’s eq_dict is considered to have the current/old
states.</p>
<p>IMPORTANT NOTE: Equipment in self.eq_dict will have their
expected_state attributes updated.</p>
<p>NOTE: It isn’t 100% clear if this is the best home for this
method, but hey, that’s okay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eq_dict_forward</strong> – dictionary of
equipment.EquipmentSinglePhase objects as would be passed
to this classes’ constructor. The states for these objects
will be what the equipment in the simulation will be
commanded to.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary with keys corresponding to the send_command
method of a gridappsd_platform.PlatformManager object.</p>
</dd>
</dl>
<p>NOTE: eq_dict_forward and self.eq_dict should be identical
except for object states.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentManager.eq_count">
<em class="property">property </em><code class="sig-name descname">eq_count</code><a class="headerlink" href="#pyvvo.equipment.EquipmentManager.eq_count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentManager.lookup_eq_by_mrid_and_phase">
<code class="sig-name descname">lookup_eq_by_mrid_and_phase</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.EquipmentManager.lookup_eq_by_mrid_and_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to look up equipment in the eq_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mrid</strong> – MRID of the equipment to find.</p></li>
<li><p><strong>phase</strong> – Optional. Phase of the equipment to find.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentManager.update_equipment_log_level">
<code class="sig-name descname">update_equipment_log_level</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">level</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>str<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#pyvvo.equipment.EquipmentManager.update_equipment_log_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Change all equipment’s logging level to the given level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>level</strong> – Logging level compatible with
logging.Logger.setLevel.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentManager.update_state">
<code class="sig-name descname">update_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#pyvvo.equipment.EquipmentManager.update_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a message from a gridappsd_platform SimOutRouter,
update equipment state. The update_state_event will be toggled
as the last thing this method does.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – list passed to this method via a SimOutRouter’s
“_on_message” method.</p></li>
<li><p><strong>sim_dt</strong> – datetime.datetime object passed to this method
via a SimOutRouter’s “_on_message” method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>count - number of EquipmentSinglePhase objects whose
state was changed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentManager.verify_command">
<code class="sig-name descname">verify_command</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wait_duration</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">timeout</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">10</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>dict<span class="p">]</span><a class="headerlink" href="#pyvvo.equipment.EquipmentManager.verify_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify equipment changes its state to match expected_state.
If the state does not match the expected state after the given
wait_duration, the equipment’s ‘operable’ parameter will be
set to False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wait_duration</strong> – How long to wait (seconds in simulation
time) before concluding that an equipment’s expected_state
does not match its state.</p></li>
<li><p><strong>timeout</strong> – How long to wait (seconds) between simulation
messages before raising a TimeOut error.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TimeoutError</strong> – if we don’t get a simulation message
within timeout seconds.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None if all equipment’s state and expected_state
parameters match. Otherwise, a dictionary of the same form
as self.eq_dict will be returned. All equipment in this
dictionary will have had their ‘operable’ parameter set to
False.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.EquipmentSinglePhase">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">EquipmentSinglePhase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mrid</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">controllable</span></em>, <em class="sig-param"><span class="n">operable</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Generic ‘equipment’ class, for e.g. capacitors and regulators.</p>
<dl class="py attribute">
<dt id="pyvvo.equipment.EquipmentSinglePhase.INVERT_STATES_FOR_COMMANDS">
<code class="sig-name descname">INVERT_STATES_FOR_COMMANDS</code><em class="property"> = False</em><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.INVERT_STATES_FOR_COMMANDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.EquipmentSinglePhase.PHASES">
<code class="sig-name descname">PHASES</code><em class="property"> = ('A', 'B', 'C')</em><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.PHASES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentSinglePhase.STATE_CIM_PROPERTY">
<em class="property">abstract property </em><code class="sig-name descname">STATE_CIM_PROPERTY</code><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.STATE_CIM_PROPERTY" title="Permalink to this definition">¶</a></dt>
<dd><p>STATE_CIM_PROPERTY defines the CIM attribute which
corresponds to an object’s ‘state’ attribute. E.g. for
regulators, it will be TapChanger.step, or for capacitors it
will be ShuntCompensator.sections. This property is used for
building commands in EquipmentManager’s
“build_equipment_commands” method.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentSinglePhase.controllable">
<em class="property">property </em><code class="sig-name descname">controllable</code><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.controllable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentSinglePhase.mrid">
<em class="property">property </em><code class="sig-name descname">mrid</code><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.mrid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentSinglePhase.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentSinglePhase.phase">
<em class="property">property </em><code class="sig-name descname">phase</code><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.phase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentSinglePhase.state">
<em class="property">property </em><code class="sig-name descname">state</code><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.EquipmentSinglePhase.state_old">
<em class="property">property </em><code class="sig-name descname">state_old</code><a class="headerlink" href="#pyvvo.equipment.EquipmentSinglePhase.state_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.InverterSinglePhase">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">InverterSinglePhase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mrid</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">phase</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">controllable</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">q</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rated_s</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">operable</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.InverterSinglePhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.equipment.PQEquipmentSinglePhase" title="pyvvo.equipment.PQEquipmentSinglePhase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.equipment.PQEquipmentSinglePhase</span></code></a></p>
<p>Single phase inverter.</p>
<dl class="py attribute">
<dt id="pyvvo.equipment.InverterSinglePhase.PHASES">
<code class="sig-name descname">PHASES</code><em class="property"> = ('A', 'B', 'C', 'S1', 'S2')</em><a class="headerlink" href="#pyvvo.equipment.InverterSinglePhase.PHASES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.InverterSinglePhase.STATE_CIM_PROPERTY">
<code class="sig-name descname">STATE_CIM_PROPERTY</code><em class="property"> = ('PowerElectronicsConnection.p', 'PowerElectronicsConnection.q')</em><a class="headerlink" href="#pyvvo.equipment.InverterSinglePhase.STATE_CIM_PROPERTY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.PQEquipmentManager">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">PQEquipmentManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_dict</span></em>, <em class="sig-param"><span class="n">eq_meas</span></em>, <em class="sig-param"><span class="n">meas_mrid_col</span></em>, <em class="sig-param"><span class="n">eq_mrid_col</span></em>, <em class="sig-param"><span class="n">eq_type</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.PQEquipmentManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.equipment.EquipmentManager" title="pyvvo.equipment.EquipmentManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.equipment.EquipmentManager</span></code></a></p>
<p>Unlike regulators, switches, and capacitors, inverters and
synchronous machines have a two-piece state: p and q. So, state
updates and building equipment commands will be different.</p>
<p>This class is designed to work with EquipmentSinglePhase subclasses
that inherit from PQEquipmentSinglePhase.</p>
<p>Initialize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_dict</strong> – Dictionary of EquipmentSinglePhase objects
as returned by regulator.initialize_regulators
or capacitor.initialize_capacitors.</p></li>
<li><p><strong>eq_meas</strong> – Pandas DataFrame as returned by
sparql.SPARQLManager’s query_rtc_measurements method, or
sparql.SPARQLManager’s query query_capacitor_measurements
method.</p></li>
<li><p><strong>meas_mrid_col</strong> – String. Column in eq_meas corresponding
to measurement MRIDs in the eq_meas DataFrame.</p></li>
<li><p><strong>eq_mrid_col</strong> – String. Column in eq_meas corresponding to
the equipment MRIDs in the eq_meas DataFrame.</p></li>
<li><p><strong>eq_type</strong> – String representing equipment type, used for
logging. E.g. “Regulator” or “Inverter”</p></li>
</ul>
</dd>
</dl>
<p>The eq_dict and eq_meas must have the same number of elements.</p>
<dl class="py method">
<dt id="pyvvo.equipment.PQEquipmentManager.build_equipment_commands">
<code class="sig-name descname">build_equipment_commands</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.PQEquipmentManager.build_equipment_commands" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to build command for changing equipment state. The
command itself should be sent with a
gridappsd_platform.PlatformManager object’s send_command method.</p>
<p>This object’s eq_dict is considered to have the current/old
states.</p>
<p>IMPORTANT NOTE: Equipment in self.eq_dict will have their
expected_state attributes updated.</p>
<p>NOTE: It isn’t 100% clear if this is the best home for this
method, but hey, that’s okay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eq_dict_forward</strong> – dictionary of
equipment.EquipmentSinglePhase objects as would be passed
to this classes’ constructor. The states for these objects
will be what the equipment in the simulation will be
commanded to.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary with keys corresponding to the send_command
method of a gridappsd_platform.PlatformManager object.</p>
</dd>
</dl>
<p>NOTE: eq_dict_forward and self.eq_dict should be identical
except for object states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.PQEquipmentSinglePhase">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">PQEquipmentSinglePhase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mrid</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">phase</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">controllable</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">q</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rated_s</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">operable</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.PQEquipmentSinglePhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.equipment.EquipmentSinglePhase" title="pyvvo.equipment.EquipmentSinglePhase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.equipment.EquipmentSinglePhase</span></code></a></p>
<p>ABSTRACT class for representing equipment whose state includes
active power (p) and reactive power (q), and the magnitude of the
apparent power must not exceed some rating.</p>
<dl class="py method">
<dt id="pyvvo.equipment.PQEquipmentSinglePhase.p">
<em class="property">property </em><code class="sig-name descname">p</code><a class="headerlink" href="#pyvvo.equipment.PQEquipmentSinglePhase.p" title="Permalink to this definition">¶</a></dt>
<dd><p>Current active power output in Watts.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.PQEquipmentSinglePhase.q">
<em class="property">property </em><code class="sig-name descname">q</code><a class="headerlink" href="#pyvvo.equipment.PQEquipmentSinglePhase.q" title="Permalink to this definition">¶</a></dt>
<dd><p>Current reactive power output in var.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.PQEquipmentSinglePhase.rated_s">
<em class="property">property </em><code class="sig-name descname">rated_s</code><a class="headerlink" href="#pyvvo.equipment.PQEquipmentSinglePhase.rated_s" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.RegulatorSinglePhase">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">RegulatorSinglePhase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mrid</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">controllable</span></em>, <em class="sig-param"><span class="n">tap_changer_mrid</span></em>, <em class="sig-param"><span class="n">step_voltage_increment</span></em>, <em class="sig-param"><span class="n">control_mode</span></em>, <em class="sig-param"><span class="n">enabled</span></em>, <em class="sig-param"><span class="n">high_step</span></em>, <em class="sig-param"><span class="n">low_step</span></em>, <em class="sig-param"><span class="n">neutral_step</span></em>, <em class="sig-param"><span class="n">step</span></em>, <em class="sig-param"><span class="n">operable</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.equipment.EquipmentSinglePhase" title="pyvvo.equipment.EquipmentSinglePhase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.equipment.EquipmentSinglePhase</span></code></a></p>
<p>Take in parameters from the CIM. See Figure 7 here:
<a class="reference external" href="https://gridappsd.readthedocs.io/en/latest/developer_resources/index.html#cim-documentation">https://gridappsd.readthedocs.io/en/latest/developer_resources/index.html#cim-documentation</a></p>
<dl class="simple">
<dt>NOTE: CIM definitions were pulled from the “CIM_GridAPPS-D_RC3”</dt><dd><p>file as viewed in Enterprise Architect.</p>
</dd>
<dt>NOTE: See sparql.SPARQLManager.REGULATOR_QUERY to see exactly</dt><dd><p>where the input parameters should come from.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mrid</strong> – MRID of this regulator. In the CIM,
TransformerTank.PowerTransformer.mRID.</p></li>
<li><p><strong>name</strong> – Name of this regulator. In the CIM,
TransformerTank.PowerTransformer.name.</p></li>
<li><p><strong>phase</strong> – Phase of the TransformerTankEnd associated with
this regulator. So, phase of the regulator.</p></li>
<li><p><strong>controllable</strong> – Boolean. Indicates if this regulator can be
controlled/commanded or not. The False case would be a
regulator that must physically be changed by a human (or a
robot? But then is a motorized control a robot? I digress.).</p></li>
<li><p><strong>tap_changer_mrid</strong> – MRID of the TapChanger.</p></li>
<li><p><strong>step_voltage_increment</strong> – Definition from CIM: “Tap step
increment, in percent of neutral voltage, per step
position.”</p></li>
<li><p><strong>control_mode</strong> – “mode” parameter from CIM RegulatingControl
object. For GridAPPS-D, could be “voltage,” “manual,” and
maybe others.</p></li>
<li><p><strong>enabled</strong> – True/False, whether the regulation is
enabled. In the CIM, RegulatingControl.enabled.</p></li>
<li><p><strong>high_step</strong> – Definition from CIM: “Highest possible tap
step position, advance from neutral. The attribute shall be
greater than lowStep.”</p></li>
<li><p><strong>low_step</strong> – Definition from CIM: “Lowest possible tap step
position, retard from neutral.”</p></li>
<li><p><strong>neutral_step</strong> – Definition from CIM: “The neutral tap step
position for this winding. The attribute shall be equal or
greater than lowStep and equal or less than highStep.”</p></li>
<li><p><strong>step</strong> – Integer only, no float.
CIM definition (new): “Tap changer position. Starting step
for a steady state solution. Non integer values are allowed
to support continuous tap variables. The reasons for
continuous value are to support study cases where no
discrete tap changers has yet been designed, a solutions
where a narrow voltage band force the tap step to oscillate
or accommodate for a continuous solution as input. The
attribute shall be equal or greater than lowStep and equal
or less than highStep.”</p></li>
<li><p><strong>operable</strong> – Whether or not the regulator is currently
accepting commands. A controllable regulator could get
“stuck,” in which case operable should be False.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="pyvvo.equipment.RegulatorSinglePhase.CONTROL_MODES">
<code class="sig-name descname">CONTROL_MODES</code><em class="property"> = ('voltage', 'activePower', 'reactivePower', 'currentFlow', 'admittance', 'timeScheduled', 'temperature', 'powerFactor')</em><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.CONTROL_MODES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.RegulatorSinglePhase.STATE_CIM_PROPERTY">
<code class="sig-name descname">STATE_CIM_PROPERTY</code><em class="property"> = 'TapChanger.step'</em><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.STATE_CIM_PROPERTY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.control_mode">
<em class="property">property </em><code class="sig-name descname">control_mode</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.control_mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.enabled">
<em class="property">property </em><code class="sig-name descname">enabled</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.enabled" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.high_step">
<em class="property">property </em><code class="sig-name descname">high_step</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.high_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.low_step">
<em class="property">property </em><code class="sig-name descname">low_step</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.low_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.lower_taps">
<em class="property">property </em><code class="sig-name descname">lower_taps</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.lower_taps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.neutral_step">
<em class="property">property </em><code class="sig-name descname">neutral_step</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.neutral_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.raise_taps">
<em class="property">property </em><code class="sig-name descname">raise_taps</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.raise_taps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.step">
<em class="property">property </em><code class="sig-name descname">step</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Step is mapped to _state.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.step_old">
<em class="property">property </em><code class="sig-name descname">step_old</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.step_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Step is mapped to the base class’s state.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.step_voltage_increment">
<em class="property">property </em><code class="sig-name descname">step_voltage_increment</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.step_voltage_increment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.tap_changer_mrid">
<em class="property">property </em><code class="sig-name descname">tap_changer_mrid</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.tap_changer_mrid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.tap_pos">
<em class="property">property </em><code class="sig-name descname">tap_pos</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.tap_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the GridLAB-D style tap position.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.equipment.RegulatorSinglePhase.tap_pos_old">
<em class="property">property </em><code class="sig-name descname">tap_pos_old</code><a class="headerlink" href="#pyvvo.equipment.RegulatorSinglePhase.tap_pos_old" title="Permalink to this definition">¶</a></dt>
<dd><p>See comments for tap_pos</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.SwitchSinglePhase">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">SwitchSinglePhase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">mrid</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">controllable</span></em>, <em class="sig-param"><span class="n">state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">operable</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.SwitchSinglePhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.equipment.EquipmentSinglePhase" title="pyvvo.equipment.EquipmentSinglePhase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.equipment.EquipmentSinglePhase</span></code></a></p>
<p>Single phase switch. For now, PyVVO is simply listening to switch
statuses, so this class is very simple and not much different from
EquipmentSinglePhase.</p>
<p>See docstring for equipment.EquipmentSinglePhase for inputs.</p>
<dl class="py attribute">
<dt id="pyvvo.equipment.SwitchSinglePhase.GLM_STATES">
<code class="sig-name descname">GLM_STATES</code><em class="property"> = {0: 'OPEN', 1: 'CLOSED'}</em><a class="headerlink" href="#pyvvo.equipment.SwitchSinglePhase.GLM_STATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.SwitchSinglePhase.INVERT_STATES_FOR_COMMANDS">
<code class="sig-name descname">INVERT_STATES_FOR_COMMANDS</code><em class="property"> = True</em><a class="headerlink" href="#pyvvo.equipment.SwitchSinglePhase.INVERT_STATES_FOR_COMMANDS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.SwitchSinglePhase.STATES">
<code class="sig-name descname">STATES</code><em class="property"> = (0, 1)</em><a class="headerlink" href="#pyvvo.equipment.SwitchSinglePhase.STATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.equipment.SwitchSinglePhase.STATE_CIM_PROPERTY">
<code class="sig-name descname">STATE_CIM_PROPERTY</code><em class="property"> = 'Switch.open'</em><a class="headerlink" href="#pyvvo.equipment.SwitchSinglePhase.STATE_CIM_PROPERTY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.equipment.SynchronousMachineSinglePhase">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">SynchronousMachineSinglePhase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mrid</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">phase</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">controllable</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">q</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rated_s</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">operable</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.SynchronousMachineSinglePhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.equipment.PQEquipmentSinglePhase" title="pyvvo.equipment.PQEquipmentSinglePhase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.equipment.PQEquipmentSinglePhase</span></code></a></p>
<p>Single phase of a synchronous machine. For now, assumed to be
a generator.</p>
<dl class="py attribute">
<dt id="pyvvo.equipment.SynchronousMachineSinglePhase.STATE_CIM_PROPERTY">
<code class="sig-name descname">STATE_CIM_PROPERTY</code><em class="property"> = ('RotatingMachine.p', 'RotatingMachine.q')</em><a class="headerlink" href="#pyvvo.equipment.SynchronousMachineSinglePhase.STATE_CIM_PROPERTY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyvvo.equipment.conditional_loop_helper">
<code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">conditional_loop_helper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_dict</span></em>, <em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.conditional_loop_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to the loop_helper, but will return a dictionary of
equipment for everywhere the func evaluates to a “truthy” value.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.equipment.initialize_capacitors">
<code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">initialize_capacitors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.initialize_capacitors" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to initialize capacitors given a DataFrame with
capacitor information. The DataFrame should come from
sparql.SPARQLManager.query_capacitors.</p>
<p>ASSUMPTION: If the ‘phase’ column value is nan, the capacitor is
a three phase cap.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.equipment.initialize_inverters">
<code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">initialize_inverters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.initialize_inverters" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to initialize inverters given a DataFrame with inverter
information. The DataFrame should come from
sparql.SPARQLManager.query_inverters.</p>
<p>Assumption: if the ‘phase’ column is NaN, the inverter is a balanced
three-phase inverter. This is also specified in the
<a class="reference external" href="https://gridappsd.readthedocs.io/en/latest/developer_resources/index.html#cim-documentation">documentation</a>.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.equipment.initialize_regulators">
<code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">initialize_regulators</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.initialize_regulators" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to initialize regulators given a DataFrame
with regulator information.</p>
<p>Note that this method relies on the fact that our SPARQL query for
regulators is tightly coupled to the __init__ inputs for
RegulatorSinglePhase objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> – Pandas DataFrame object from
sparql.SPARQLManager.query_regulators</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>out: dictionary, keyed by tap_changer_mrid, of
RegulatorSinglePhase objects. Note that all regulators are
included, even if they aren’t controllable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.equipment.initialize_switches">
<code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">initialize_switches</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.initialize_switches" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to initialize switches given a DataFrame with switch
information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> – Pandas DataFrame from sparql.SPARQLManager.query_switches</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>out: Dictionary, keyed by MRID, of SwitchSinglePhase
objects. The values in the dictionary will either be
SwitchSinglePhase or dictionaries of SwitchSinglePhase objects,
keyed by phase.</p>
</dd>
</dl>
<p>ASSUMPTION: If the ‘phase’ column value is nan, the switch is a
three phase switch.</p>
<dl class="simple">
<dt>TODO: Currently, I’m hard-coding all switches to not be</dt><dd><p>controllable. At present, pyVVO won’t be commanding switches,
only listening to their statuses, so this is no big deal.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.equipment.initialize_synchronous_machines">
<code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">initialize_synchronous_machines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.initialize_synchronous_machines" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to initialize synchronous machines given a DataFrame with
machine information. The DataFrame should come from
sparql.SPARQLManager.query_synchronous_machines.</p>
<p>Assumption: all machines are balanced three-phase as noted in the
<a class="reference external" href="https://gridappsd.readthedocs.io/en/latest/developer_resources/index.html#cim-documentation">documentation</a></p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.equipment.loop_helper">
<code class="sig-prename descclassname">pyvvo.equipment.</code><code class="sig-name descname">loop_helper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">eq_dict</span></em>, <em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.equipment.loop_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop over an equipment dictionary returned from one of the
initialize_* functions and apply a function to each
EquipmentSinglePhase object.</p>
<p>I constantly find myself re-writing these annoying loops due to
the poor design decision to allow the initialize_* functions to
have either EquipmentSinglePhase objects or dictionaries as the
values for the top level values of their respective returns. So,
this method hopefully mitigates that.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_dict</strong> – Dictionary from one of this modules initialize_*
functions (e.g. initialize_regulators).</p></li>
<li><p><strong>func</strong> – Function which takes two positional inputs: a single
EquipmentSinglePhase object as input.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.ga">
<span id="ga-py"></span><h2>ga.py<a class="headerlink" href="#module-pyvvo.ga" title="Permalink to this headline">¶</a></h2>
<p>Module for PyVVO’s genetic algorithm.</p>
<dl class="py exception">
<dt id="pyvvo.ga.ChromosomeAlreadyExistedError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">ChromosomeAlreadyExistedError</code><a class="headerlink" href="#pyvvo.ga.ChromosomeAlreadyExistedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.ga.Error" title="pyvvo.ga.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.ga.Error</span></code></a></p>
<p>Raised if a chromosome has already been existed.</p>
</dd></dl>

<dl class="py exception">
<dt id="pyvvo.ga.DeadProcessError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">DeadProcessError</code><a class="headerlink" href="#pyvvo.ga.DeadProcessError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.ga.Error" title="pyvvo.ga.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.ga.Error</span></code></a></p>
<p>Raised when a Population object has a dead process but shouldn’t.</p>
</dd></dl>

<dl class="py exception">
<dt id="pyvvo.ga.Error">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">Error</code><a class="headerlink" href="#pyvvo.ga.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base class for exceptions in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="pyvvo.ga.GA">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">GA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">regulators</span></em>, <em class="sig-param"><span class="n">capacitors</span></em>, <em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">stoptime</span></em>, <em class="sig-param"><span class="n">stop_timeout</span><span class="o">=</span><span class="default_value">120.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.GA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for managing the genetic algorithm. Use the “run” and
“stop” methods to start/stop the algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regulators</strong> – dictionary as returned by
equipment.initialize_regulators. Since the states of
these objects will be altered after the algorithm has run,
a deepcopy will be made.</p></li>
<li><p><strong>capacitors</strong> – dictionary as returned by
equipment.initialize_capacitors. Since the states of
these objects will be altered after the algorithm has run,
a deepcopy will be made.</p></li>
<li><p><strong>starttime</strong> – Python datetime object for simulation start.
For more details, see the docstring for prep_glm_mgr.</p></li>
<li><p><strong>stoptime</strong> – Python datetime object for simulation end. See
prep_glm_mgr.</p></li>
<li><p><strong>stop_timeout</strong> – Timeout (seconds) for waiting on the
algorithm to stop after the “stop” method is called. If this
timeout is exceeded, future calls to “run” will do nothing.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyvvo.ga.GA.capacitors">
<em class="property">property </em><code class="sig-name descname">capacitors</code><a class="headerlink" href="#pyvvo.ga.GA.capacitors" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary as returned by equipment.initialize_capacitors.
The underlying capacitor object states will be modified by the
algorithm.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.population">
<em class="property">property </em><code class="sig-name descname">population</code><a class="headerlink" href="#pyvvo.ga.GA.population" title="Permalink to this definition">¶</a></dt>
<dd><p>ga.Population object, or None if the algorithm has not yet
been run.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.regulators">
<em class="property">property </em><code class="sig-name descname">regulators</code><a class="headerlink" href="#pyvvo.ga.GA.regulators" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary as returned by equipment.initialize_regulators.
The underlying regulator object states will be modified by the
algorithm</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">glm_mgr</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.GA.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the genetic algorithm. This runs the algorithm in a
thread for easy interruption. It will return before the genetic
algorithm is complete (as soon as the thread is started).</p>
<p>Recall that this class’s “running” property indicates whether
or not the genetic algorithm is currently running.</p>
<p>After the genetic algorithm finishes, self.regulators and
self.capacitors will get updated with the settings from the
best individual. Then, one could use an EquipmentManager’s
“build_equipment_commands” method in conjunction with this
object’s self.regulators/self.capacitors attributes in order
to get commands ready to send into the GridAPPS-D platform.</p>
<p>If you’d like to wait for the algorithm to complete, use this
class’s “wait” method after calling “run.”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>glm_mgr</strong> – glm.GLMManager object. The model will be updated
via this modules ‘prep_glm_mgr’ function, so this object
should just be the raw model from the platform. Since the
states of these objects will be altered after the algorithm
has run, a deepcopy will be made.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.run_event">
<em class="property">property </em><code class="sig-name descname">run_event</code><a class="headerlink" href="#pyvvo.ga.GA.run_event" title="Permalink to this definition">¶</a></dt>
<dd><p>threading.Event object. If self.run_event.is_set() returns
True, the genetic algorithm is permitted to run. If is_set()
instead returns False, the genetic algorithm is not permitted
to run, and will begin shutting down if it was in progress.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.run_thread">
<em class="property">property </em><code class="sig-name descname">run_thread</code><a class="headerlink" href="#pyvvo.ga.GA.run_thread" title="Permalink to this definition">¶</a></dt>
<dd><p>Thread used to run the genetic algorithm.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.running">
<em class="property">property </em><code class="sig-name descname">running</code><a class="headerlink" href="#pyvvo.ga.GA.running" title="Permalink to this definition">¶</a></dt>
<dd><p>True if the genetic algorithm is running, False otherwise.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.starttime">
<em class="property">property </em><code class="sig-name descname">starttime</code><a class="headerlink" href="#pyvvo.ga.GA.starttime" title="Permalink to this definition">¶</a></dt>
<dd><p>Python datetime object for simulation start. For more
details, see the docstring for prep_glm_mgr.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.GA.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to interrupt the running genetic algorithm. This
method will immediately return after kicking off the stopping
process. To check on whether or not the genetic algorithm is
still running, check self.running.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.stoptime">
<em class="property">property </em><code class="sig-name descname">stoptime</code><a class="headerlink" href="#pyvvo.ga.GA.stoptime" title="Permalink to this definition">¶</a></dt>
<dd><p>Python datetime object for simulation end. For more
details, see the docstring for prep_glm_mgr.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.GA.wait">
<code class="sig-name descname">wait</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.GA.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the “run” method to complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timeout</strong> – Time (seconds) to wait for the “run” method to
complete. Defaults to None (wait forever).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>TimeoutError</strong> – </p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyvvo.ga.GAInterruptedError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">GAInterruptedError</code><a class="headerlink" href="#pyvvo.ga.GAInterruptedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.ga.Error" title="pyvvo.ga.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.ga.Error</span></code></a></p>
<p>Raised when the genetic algorithm is externally interrupted.</p>
</dd></dl>

<dl class="py class">
<dt id="pyvvo.ga.Individual">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">Individual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">uid</span></em>, <em class="sig-param"><span class="n">chrom_len</span></em>, <em class="sig-param"><span class="n">num_eq</span></em>, <em class="sig-param"><span class="n">chrom_map</span></em>, <em class="sig-param"><span class="n">chrom_override</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">special_init</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Individual" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for representing an individual in the genetic algorithm.</p>
<p>Initialize an individual for the genetic algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uid</strong> – Unique identifier for this individual. Integer.</p></li>
<li><p><strong>chrom_len</strong> – Length of chromosome to generate. This is the
second return from the map_chromosome method of this module.</p></li>
<li><p><strong>num_eq</strong> – Total number of equipment.EquipmentSinglePhase
objects present in the chrom_map input. This is the third
return from the map_chromosome method of this module.</p></li>
<li><p><strong>chrom_map</strong> – Dictionary mapping of the chromosome. Comes
from the first return of the map_chromosome method.</p></li>
<li><p><strong>chrom_override</strong> – If provided (not None), this chromosome
is used instead of randomly generating one. Must be a
numpy.ndarray with dtype np.bool and shape (chrom_len,).</p></li>
<li><p><strong>special_init</strong> – <p>String or None (default). Flag for special
initialization. The options are:
- None: Default. Randomly initialize the chromosome to</p>
<blockquote>
<div><p>values within each equipment’s valid range.</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>’max’: All equipment will be initialized to the maximum of</dt><dd><p>their range. For regulators, this means top tap, and for
capacitors this means closed.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’min’: All equipment will be initialized to the minimum of</dt><dd><p>their range. For regulators, this means bottom tap, and
for capacitors this means open.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’current_state’: All equipment will be initialized via</dt><dd><p>their ‘current_state’ attribute within the chrom_map.
Note that the current state is taken at the time of
mapping, and could possibly change over time without
being reflected in the map’s ‘current_state’ attribute.</p>
</dd>
</dl>
</li>
</ul>
<dl class="simple">
<dt>NOTE: special_init will be ignored if chrom_override is not</dt><dd><p>None.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>NOTE: It is expected that chrom_len, num_eq, and chrom_map come</dt><dd><p>from the same call to map_chromosome. Thus, there will be no
integrity checks to ensure they align.</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="pyvvo.ga.Individual.SPECIAL_INIT_OPTIONS">
<code class="sig-name descname">SPECIAL_INIT_OPTIONS</code><em class="property"> = (None, 'max', 'min', 'current_state')</em><a class="headerlink" href="#pyvvo.ga.Individual.SPECIAL_INIT_OPTIONS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.chrom_len">
<em class="property">property </em><code class="sig-name descname">chrom_len</code><a class="headerlink" href="#pyvvo.ga.Individual.chrom_len" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.chrom_map">
<em class="property">property </em><code class="sig-name descname">chrom_map</code><a class="headerlink" href="#pyvvo.ga.Individual.chrom_map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.chromosome">
<em class="property">property </em><code class="sig-name descname">chromosome</code><a class="headerlink" href="#pyvvo.ga.Individual.chromosome" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.crossover_by_gene">
<code class="sig-name descname">crossover_by_gene</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em>, <em class="sig-param"><span class="n">uid1</span></em>, <em class="sig-param"><span class="n">uid2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Individual.crossover_by_gene" title="Permalink to this definition">¶</a></dt>
<dd><p>Rather than performing a per-bit crossover like in
crossover_uniform, instead crossover by gene. In our problem,
each gene encodes for a piece of equipment. So, randomly
(uniform distribution) determine on a per-equipment basis what
each new child will get.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – ga.Individual</p></li>
<li><p><strong>uid1</strong> – uid to give to first child of crossover.</p></li>
<li><p><strong>uid2</strong> – uid to give to second child of crossover.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.crossover_uniform">
<code class="sig-name descname">crossover_uniform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em>, <em class="sig-param"><span class="n">uid1</span></em>, <em class="sig-param"><span class="n">uid2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Individual.crossover_uniform" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a uniform crossover between self and other, returning
two children.</p>
<p>Good reference:
<a class="reference external" href="https://www.tutorialspoint.com/genetic_algorithms/genetic_algorithms_crossover.htm">https://www.tutorialspoint.com/genetic_algorithms/genetic_algorithms_crossover.htm</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – initialize ga.Individual object.</p></li>
<li><p><strong>uid1</strong> – uid for child 1.</p></li>
<li><p><strong>uid2</strong> – uid for child 2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">glm_mgr</span></em>, <em class="sig-param"><span class="n">db_conn</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Individual.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Write + run GridLAB-D model, compute costs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glm_mgr</strong> – Initialized glm.GLMManager object, which has
already been updated via this module’s prep_glm_mgr
function. NOTE: This manager WILL BE MODIFIED, so ensure a
copy is passed in.</p></li>
<li><p><strong>db_conn</strong> – Active database connection which follows
PEP 249.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.fitness">
<em class="property">property </em><code class="sig-name descname">fitness</code><a class="headerlink" href="#pyvvo.ga.Individual.fitness" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.mutate">
<code class="sig-name descname">mutate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mut_prob</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Individual.mutate" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple bit-flipping mutation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mut_prob</strong> – Probability an individual bit is flipped.
Should be low. On the interval [0, 1]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.num_eq">
<em class="property">property </em><code class="sig-name descname">num_eq</code><a class="headerlink" href="#pyvvo.ga.Individual.num_eq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.penalties">
<em class="property">property </em><code class="sig-name descname">penalties</code><a class="headerlink" href="#pyvvo.ga.Individual.penalties" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.special_init">
<em class="property">property </em><code class="sig-name descname">special_init</code><a class="headerlink" href="#pyvvo.ga.Individual.special_init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Individual.uid">
<em class="property">property </em><code class="sig-name descname">uid</code><a class="headerlink" href="#pyvvo.ga.Individual.uid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.ga.Population">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">Population</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">regulators</span></em>, <em class="sig-param"><span class="n">capacitors</span></em>, <em class="sig-param"><span class="n">glm_mgr</span></em>, <em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">stoptime</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for managing a population of individuals for the GA.</p>
<p>TODO: Document params.</p>
<dl class="py method">
<dt id="pyvvo.ga.Population.all_chromosomes">
<em class="property">property </em><code class="sig-name descname">all_chromosomes</code><a class="headerlink" href="#pyvvo.ga.Population.all_chromosomes" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all chromosomes which have occurred over the course
of the genetic algorithm. For the 8500 node model, evaluation
takes on the order of 20 or so seconds for a 20 second
simulation (lots of overhead to start simulation), so it’s
almost certainly faster to ensure we never have duplicates.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.all_processes_alive">
<em class="property">property </em><code class="sig-name descname">all_processes_alive</code><a class="headerlink" href="#pyvvo.ga.Population.all_processes_alive" title="Permalink to this definition">¶</a></dt>
<dd><p>True if all processes return True on is_alive(), else False.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.all_processes_dead">
<em class="property">property </em><code class="sig-name descname">all_processes_dead</code><a class="headerlink" href="#pyvvo.ga.Population.all_processes_dead" title="Permalink to this definition">¶</a></dt>
<dd><p>True if all processes return False on is_alive(), else True.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.capacitors">
<em class="property">property </em><code class="sig-name descname">capacitors</code><a class="headerlink" href="#pyvvo.ga.Population.capacitors" title="Permalink to this definition">¶</a></dt>
<dd><p>Capacitor input from equipment.initialize_capacitors.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.chrom_len">
<em class="property">property </em><code class="sig-name descname">chrom_len</code><a class="headerlink" href="#pyvvo.ga.Population.chrom_len" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer representing the length of each Individual’s
chromosome. Output from map_chromosome.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.chrom_map">
<em class="property">property </em><code class="sig-name descname">chrom_map</code><a class="headerlink" href="#pyvvo.ga.Population.chrom_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary output from map_chromosome.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.crossover_and_mutate">
<code class="sig-name descname">crossover_and_mutate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.crossover_and_mutate" title="Permalink to this definition">¶</a></dt>
<dd><p>Replenish the population via crossover and mutation.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.evaluate_population">
<code class="sig-name descname">evaluate_population</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.evaluate_population" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate all individuals in the population who haven’t yet
been evaluated. NOTE: This can take a while, depending on the
model, etc.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.forceful_shutdown">
<code class="sig-name descname">forceful_shutdown</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.forceful_shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a bit tricky due to (probably) bad design. We have
each process attached to a target, in this case that target is
_evaluate_worker. During the course of running, the process
opens up a subprocess to run GridLAB-D. Currently, that’s done
with subprocess.run, which doesn’t allow us to kill the
running subprocess. I’m concerned that if we just send the
terminate or kill signal to the process, the GridLAB-D process
will either keep running or die in a way that causes issues
(like bad stuff with MySQL). In the former case (GLD keeps
running), the forceful shutdown is practically pointless. Sure,
it’ll save some queries to the database during evaluation, but
that’s not where the heavy lifting is. In the latter case (the
GLD process is forcefully stopped), we could totally hose
things. So, until there’s a compelling reason to implement a
forceful shutdown, let’s call it good with the graceful
shutdown.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.generations">
<em class="property">property </em><code class="sig-name descname">generations</code><a class="headerlink" href="#pyvvo.ga.Population.generations" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of generations of the genetic algorithm to run.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.glm_mgr">
<em class="property">property </em><code class="sig-name descname">glm_mgr</code><a class="headerlink" href="#pyvvo.ga.Population.glm_mgr" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialized glm.GLMManager. Will be prepped via the
prep_glm_mgr function.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.graceful_shutdown">
<code class="sig-name descname">graceful_shutdown</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.graceful_shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to “gracefully” stop an in-progress run of
evaluate_population. By “gracefully”, I mean that no processes
will be terminated mid-run. Instead, the queue will be emptied
out, and then the processes terminated.</p>
<p>For now, “graceful” does not mean that we can simply resume
where we left off. If that is desired later, it’ll be pretty
similar to this method, and not too complicated.</p>
<p>Note this method is intended to be run quickly and exit. It will
not wait for the processes to finish. If the processes should
be waited on, this should happen outside of this method.</p>
<p>Check the all_processes_dead attribute to ensure everything’s
been killed.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.ind_init">
<em class="property">property </em><code class="sig-name descname">ind_init</code><a class="headerlink" href="#pyvvo.ga.Population.ind_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper dictionary for initializing individuals.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.initialize_population">
<code class="sig-name descname">initialize_population</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.initialize_population" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize and the first generation. To keep methods simple
and modular, evaluation will not occur.</p>
<p>The population will be seeded with three individuals.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.input_queue">
<em class="property">property </em><code class="sig-name descname">input_queue</code><a class="headerlink" href="#pyvvo.ga.Population.input_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Queue which initialized individuals are put into for
evaluation in a separate process.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.log_interval">
<em class="property">property </em><code class="sig-name descname">log_interval</code><a class="headerlink" href="#pyvvo.ga.Population.log_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>How often (seconds) to log during evaluation.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.logging_queue">
<em class="property">property </em><code class="sig-name descname">logging_queue</code><a class="headerlink" href="#pyvvo.ga.Population.logging_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Queue used for logging when individuals complete their
evaluation.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.logging_thread">
<em class="property">property </em><code class="sig-name descname">logging_thread</code><a class="headerlink" href="#pyvvo.ga.Population.logging_thread" title="Permalink to this definition">¶</a></dt>
<dd><p>Thread for loggin individual evaluation.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.natural_selection">
<code class="sig-name descname">natural_selection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.natural_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim the population via both elitism and tournaments.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.num_eq">
<em class="property">property </em><code class="sig-name descname">num_eq</code><a class="headerlink" href="#pyvvo.ga.Population.num_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of equipment in the chrom_map. Output from
map_chromosome.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.output_queue">
<em class="property">property </em><code class="sig-name descname">output_queue</code><a class="headerlink" href="#pyvvo.ga.Population.output_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Queue which individuals are placed in after evaluation is
complete.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.population">
<em class="property">property </em><code class="sig-name descname">population</code><a class="headerlink" href="#pyvvo.ga.Population.population" title="Permalink to this definition">¶</a></dt>
<dd><p>List of all current individuals.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.population_size">
<em class="property">property </em><code class="sig-name descname">population_size</code><a class="headerlink" href="#pyvvo.ga.Population.population_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of individuals in the population.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.prob_crossover">
<em class="property">property </em><code class="sig-name descname">prob_crossover</code><a class="headerlink" href="#pyvvo.ga.Population.prob_crossover" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two parents, probability that they ‘mate’ (crossover).
If the random draw dictates there will be no crossover,
offspring will be mutated versions of their parents.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.prob_mutate_bit">
<em class="property">property </em><code class="sig-name descname">prob_mutate_bit</code><a class="headerlink" href="#pyvvo.ga.Population.prob_mutate_bit" title="Permalink to this definition">¶</a></dt>
<dd><p>Per bit bit-flip probability for an individual in the
mutation phase.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.prob_mutate_individual">
<em class="property">property </em><code class="sig-name descname">prob_mutate_individual</code><a class="headerlink" href="#pyvvo.ga.Population.prob_mutate_individual" title="Permalink to this definition">¶</a></dt>
<dd><p>Probability an individual enters the mutation phase. Does not
guarantee an individual is actually mutated, as mutation is
performed bit by bit and depends on prob_mutate_bit.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.processes">
<em class="property">property </em><code class="sig-name descname">processes</code><a class="headerlink" href="#pyvvo.ga.Population.processes" title="Permalink to this definition">¶</a></dt>
<dd><p>List of processes for performing individual evaluation.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.regulators">
<em class="property">property </em><code class="sig-name descname">regulators</code><a class="headerlink" href="#pyvvo.ga.Population.regulators" title="Permalink to this definition">¶</a></dt>
<dd><p>Regulator input from equipment.initialize_regulators.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.sort_population">
<code class="sig-name descname">sort_population</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.sort_population" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to sort the population in place. After this method
is called, the individual with the lowest fitness (the best)
will be in position 0.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.starttime">
<em class="property">property </em><code class="sig-name descname">starttime</code><a class="headerlink" href="#pyvvo.ga.Population.starttime" title="Permalink to this definition">¶</a></dt>
<dd><p>Python datetime representing simulation start.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.stoptime">
<em class="property">property </em><code class="sig-name descname">stoptime</code><a class="headerlink" href="#pyvvo.ga.Population.stoptime" title="Permalink to this definition">¶</a></dt>
<dd><p>Python datetime representing simulation stop.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.top_fraction">
<em class="property">property </em><code class="sig-name descname">top_fraction</code><a class="headerlink" href="#pyvvo.ga.Population.top_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Fraction of the most fit individuals that are guaranteed to
survive to the next generation.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.top_keep">
<em class="property">property </em><code class="sig-name descname">top_keep</code><a class="headerlink" href="#pyvvo.ga.Population.top_keep" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of individuals to keep. ceil(population_size
* top_fraction)</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.total_fraction">
<em class="property">property </em><code class="sig-name descname">total_fraction</code><a class="headerlink" href="#pyvvo.ga.Population.total_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Total fraction of individuals that survive to the next
generation, and will be considered for crossover + mutation.
Note this fraction includes top_fraction.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.total_keep">
<em class="property">property </em><code class="sig-name descname">total_keep</code><a class="headerlink" href="#pyvvo.ga.Population.total_keep" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of individuals to keep. ceil(population_size
* total_fraction)</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.tournament_fraction">
<em class="property">property </em><code class="sig-name descname">tournament_fraction</code><a class="headerlink" href="#pyvvo.ga.Population.tournament_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Fraction of the population to draw for each round of
tournament selection.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.tournament_size">
<em class="property">property </em><code class="sig-name descname">tournament_size</code><a class="headerlink" href="#pyvvo.ga.Population.tournament_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of individuals per tournament.
ceil(population_size * tournament_fraction)</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.uid_counter">
<em class="property">property </em><code class="sig-name descname">uid_counter</code><a class="headerlink" href="#pyvvo.ga.Population.uid_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple iterator for incrementing UIDs to assign to
individuals.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.ga.Population.wait_for_processes">
<code class="sig-name descname">wait_for_processes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timeout</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>float<span class="p">, </span>int<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.Population.wait_for_processes" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the processes to terminate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timeout</strong> – Time in seconds to wait for each individual
process.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TimeoutError</strong> – if any process does not terminate within
the given timeout.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyvvo.ga.cim_to_glm_name">
<code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">cim_to_glm_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="n">cim_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.cim_to_glm_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to manage the fact that we need to prefix our object names
to make them match what’s in the GridLAB-D model.</p>
<p>Also, if the given name is NOT surrounded by quotes, it will be.
It would appear that all the ‘name’ attributes in the GridLAB-D
models from the platform are quoted with quotes. However, when
querying the CIM triple-store, the names do NOT come back with
quotes.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.ga.map_chromosome">
<code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">map_chromosome</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">regulators</span></em>, <em class="sig-param"><span class="n">capacitors</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.map_chromosome" title="Permalink to this definition">¶</a></dt>
<dd><p>Given regulators and capacitors, map states onto a chromosome.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regulators</strong> – dictionary as returned by
equipment.initialize_regulators</p></li>
<li><p><strong>capacitors</strong> – dictionary as returned by
equipment.initialize_capacitors</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>map_out, idx, and num_eq.
map_out is a dict keyed by equipment name. Each equipment maps</p>
<blockquote>
<div><p>to a dictionary keyed by phase (A, B, or C). These phase
dictionaries have the following fields:
- ‘idx’: Tuple with a pair of integers, indicating the</p>
<blockquote>
<div><p>indices on the chromosome for this particular piece of
equipment. These indices can simply be used like so:</p>
<blockquote>
<div><p>dict[‘idx’][0]:dict[‘idx’][1]</p>
</div></blockquote>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>’eq_obj’: The equipment object itself. At the moment,</dt><dd><p>these will be equipment.CapacitorSinglePhase or
equipment.RegulatorSinglePhase objects.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’range’: Tuple with a pair of integers, indicating the</dt><dd><p>(low, high) range of states the equipment can take on.
This is for convenience, and enables the Individual
class to be agnostic about the differences between
equipment.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>idx is an integer representing the full length of the chromosome</dt><dd><p>needed to represent all the equipment.</p>
</dd>
<dt>num_eq is an integer indicating the total number of single phase</dt><dd><p>equipment objects.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.ga.prep_glm_mgr">
<code class="sig-prename descclassname">pyvvo.ga.</code><code class="sig-name descname">prep_glm_mgr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">glm_mgr</span></em>, <em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">stoptime</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.ga.prep_glm_mgr" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to get a glm.GLMManager object ready to run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glm_mgr</strong> – glm.GLMManager object, which has been instantiated
by passing the result from a
gridappsd_platform.PlatformManager’s get_glm method.</p></li>
<li><p><strong>starttime</strong> – Python datetime.datetime object for simulation
start. Do everyone a favor: convert to UTC.</p></li>
<li><p><strong>stoptime</strong> – See starttime, but for simulation stop.</p></li>
</ul>
</dd>
</dl>
<p>This method will update the glm_mgr as follows:
1) Call glm_mgr.add_run_components, passing in starttime and</p>
<blockquote>
<div><p>stoptime.
NOTE: This method has more inputs, which we could update later.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Ensure all regulators are set to MANUAL control.</p></li>
<li><p>Ensure all capacitors are set to MANUAL control.</p></li>
<li><p>Add all triplex_load objects to a group.</p></li>
<li><p>Add the MySQL module to the model.</p></li>
<li><dl class="simple">
<dt>Add database object. The following environment variables (</dt><dd><dl class="simple">
<dt>at present defined in docker-compose.yml) are necessary:</dt><dd><p>DB_HOST: hostname of the MySQL database.
DB_USER: User to use to connect to MySQL.
DB_PASS: Password for DB_USER.
DB_DB: Database to use.
DB_PORT: Port to connect to MySQL.</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p>Add a recorder for the triplex group.</p></li>
<li><p>Add a meter to the substation object.</p></li>
<li><p>Add a recorder for the substation meter.</p></li>
</ol>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.glm">
<span id="glm-py"></span><h2>glm.py<a class="headerlink" href="#module-pyvvo.glm" title="Permalink to this headline">¶</a></h2>
<p>This module is used to ingest a GridLAB-D model (extension .glm) into a
Python dictionary where the model can easily be modified. Then, the
modified model can be easily written to file.</p>
<p>A user of this module will likely only ever want to use the GLMManager
class (author: Brandon Thayer).</p>
<dl class="simple">
<dt>Original functions (modified) from Jacob and Ebony:</dt><dd><dl class="simple">
<dt>parse(inputStr, filePath=True):</dt><dd><p>Main function to parse in glm</p>
</dd>
<dt>_tokenize_glm(inputStr, filePath=True):</dt><dd><p>Helper function to parse glm</p>
</dd>
<dt>_parse_token_list(tokenList):</dt><dd><p>Helper function to parse glm</p>
</dd>
<dt>sorted_write(inTree):</dt><dd><p>Main function to write out glm</p>
</dd>
<dt>_dict_to_string(inDict):</dt><dd><p>Helper function to write out glm</p>
</dd>
<dt>_gather_key_values(inDict, keyToAvoid):</dt><dd><p>Helper function to write out glm</p>
</dd>
</dl>
</dd>
<dt>Adopted and modified August 30, 2018 by Brandon Thayer</dt><dd><p>(<a class="reference external" href="mailto:brandon&#46;thayer&#37;&#52;&#48;pnnl&#46;gov">brandon<span>&#46;</span>thayer<span>&#64;</span>pnnl<span>&#46;</span>gov</a>)</p>
</dd>
</dl>
<p>Modified March 28, 2017 by Jacob Hansen (<a class="reference external" href="mailto:jacob&#46;hansen&#37;&#52;&#48;pnnl&#46;gov">jacob<span>&#46;</span>hansen<span>&#64;</span>pnnl<span>&#46;</span>gov</a>)
Created October 27, 2014 by Ebony Mayhorn (<a class="reference external" href="mailto:ebony&#46;mayhorn&#37;&#52;&#48;pnnl&#46;gov">ebony<span>&#46;</span>mayhorn<span>&#64;</span>pnnl<span>&#46;</span>gov</a>)</p>
<p>Copyright (c) 2019 Battelle Memorial Institute.  The Government retains
a paid-up nonexclusive, irrevocable worldwide license to reproduce,
prepare derivative works, perform publicly and display publicly by or
for the Government, including the right to distribute to other
Government contractors.</p>
<dl class="py exception">
<dt id="pyvvo.glm.Error">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.glm.</code><code class="sig-name descname">Error</code><a class="headerlink" href="#pyvvo.glm.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base class for exceptions in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="pyvvo.glm.GLMManager">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.glm.</code><code class="sig-name descname">GLMManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">model_is_path</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to manage a GridLAB-D model (.glm).</p>
<dl>
<dt>Public methods:</dt><dd><ul class="simple">
<li><p>write_model: Write model to file.</p></li>
<li><p>add_item: Given an item dict, add it to the model.</p></li>
<li><p>find_object: Lookup an object by type and name.</p></li>
<li><dl class="simple">
<dt>get_items_by_type: Lookup all items of a given type. Return a</dt><dd><p>dictionary keyed by name.</p>
</dd>
</dl>
</li>
<li><p>modify_item: Update an item’s properties (no renaming, though)</p></li>
<li><dl class="simple">
<dt>remove_properties_from_item: Delete certain properties from</dt><dd><p>an item.</p>
</dd>
</dl>
</li>
<li><p>remove_item: Remove an item from the model</p></li>
<li><p>module_present: Test if a particular module is in the model.</p></li>
<li><dl class="simple">
<dt>get_objects_by_type: Return all objects of a given type as a</dt><dd><p>list.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>add_or_modify_clock: Add clock if not present, or update</dt><dd><p>existing clock.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>object_type_present: Check if a given object type exists in</dt><dd><p>the model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>add_run_components: Helper for adding necessary pieces to get</dt><dd><p>a model running when we’re just given the “base” model from
the GridAPPS-D platform. This “base” model is missing
modules, a clock, etc.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>add_substation_meter: Add a meter which monitors the</dt><dd><p>swing bus (a substation object). All objects which were
connected to the swing are modified to be connected to the
new meter.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>update_reg_taps: Update a regulator’s tap positions, both in</dt><dd><p>the regulator itself, and its corresponding configuration.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>clear_all_triplex_loads: Clear out all parameters in</dt><dd><p>TRIPLEX_PARAMS for all triplex_load objects in the model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>update_all_triplex_loads: Well, update all the triplex loads</dt><dd><p>in the model. Self explanatory :) Check the docstring.</p>
</dd>
</dl>
</li>
<li><p>remove_all_solar: Remove all solar panels from the model.</p></li>
<li><dl class="simple">
<dt>set_inverter_v_and_i: Add V_In and I_In to inverters according</dt><dd><p>to their rated power (essentially giving them a DC source).</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>IMPORTANT NOTE ON MUTABILITY:</dt><dd><p>As Python programmers should know, dictionaries are mutable, and
thus pointers are effectively used. When using methods which 
return a dictionary or collection of dictionaries representing
model components (e.g. objects of type meter or the model’s
clock), this dictionary points directly to the same dictionary
the GLMManager uses. Thus, these dictionaries SHOULD NOT BE 
MODIFIED. While this hazard could be circumnavigated by 
returning copies, that’s simply not efficient and in my opinion,
overkill. So, if you need to make modifications, make a copy. If
you are intentionally modifying an object, use one of the public
methods to do so.</p>
</dd>
<dt>A note on “items” vs. “objects”:</dt><dd><p>Any encapsulated element in a GridLAB-D model is considered an
“item.” E.g. a one-line module declaration or a mult-line
object definition. “objects” are specifically GridLAB-D objects.
E.g., their definition is like “object &lt;object type&gt; { …”</p>
</dd>
<dt>A note on “item_dict” inputs:</dt><dd><p>item_dicts are Python dictionaries which represent GridLAB-D
“items”. This simplest case is a GridLAB-D object. The
item_dict must have an “object” field, and the “object” field’s
value would be the object type. E.g. “recorder”. All the
remaining key-value pairs define the object’s properties. Some
examples follow:</p>
<p>{‘object’: ‘capacitor’, ‘name’: ‘“my_cap”’}
{‘module’: ‘powerflow’}
{‘clock’: ‘clock’, ‘starttime’: ‘’2012-01-01 00:00:00’’,</p>
<blockquote>
<div><p>‘stoptime’: ‘’2017-06-10 08:35:12’’, ‘timezone’: ‘Pacific’}</p>
</div></blockquote>
<p>{‘#define’: ‘VSOURCE=66395.28’}</p>
</dd>
<dt>A note on nested items:</dt><dd><p>Nested items (e.g. a recorder nested in an object or a
transformer_configuration object nested within a transformer
object) will be “un-nested.” They’ll be given name/parent
attributes as necessary.</p>
</dd>
<dt>Some notes on “class”es:</dt><dd><p>The GLMManager (and this module, for that matter) currently
ONLY supports simple classes with property definitions. If they
have functions, that won’t work.</p>
<p>ALSO: Classes cannot have enumerations or sets, as this will
break things.</p>
<p>The reason for these short-comings is how the manager deals with
nesting. Seeing curly braces within an object is how nesting is
detected, and currently nested objects are “un-nested.”</p>
<p>Finally, not all the methods for accessing and modifying classes
have been created yet.</p>
</dd>
</dl>
<p>Initialize by parsing given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – Path to or string of GridLAB-D model.</p></li>
<li><p><strong>model_is_path</strong> (<em>Boolean</em>) – Specifies if model is path (True) or
string of model (False)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="pyvvo.glm.GLMManager.DATE_FORMAT">
<code class="sig-name descname">DATE_FORMAT</code><em class="property"> = '%Y-%m-%d %H:%M:%S'</em><a class="headerlink" href="#pyvvo.glm.GLMManager.DATE_FORMAT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.glm.GLMManager.NON_OBJECTS">
<code class="sig-name descname">NON_OBJECTS</code><em class="property"> = ('clock', 'module', 'include', 'set', 'define', 'omftype', 'class')</em><a class="headerlink" href="#pyvvo.glm.GLMManager.NON_OBJECTS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.glm.GLMManager.NO_MAP">
<code class="sig-name descname">NO_MAP</code><em class="property"> = ('set', 'include', 'define')</em><a class="headerlink" href="#pyvvo.glm.GLMManager.NO_MAP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.add_item">
<code class="sig-name descname">add_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.add_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Add and map a new item.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item_dict</strong> (<em>dict</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.add_or_modify_clock">
<code class="sig-name descname">add_or_modify_clock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">starttime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">stoptime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">timezone</span><span class="o">=</span><span class="default_value">'UTC0'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.add_or_modify_clock" title="Permalink to this definition">¶</a></dt>
<dd><p>Add clock to the model if it exists, otherwise modify clock.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starttime</strong> – datetime.datetime object</p></li>
<li><p><strong>stoptime</strong> – datetime.datetime object</p></li>
<li><p><strong>timezone</strong> – string, should be valid timezone. See here:
<a class="reference external" href="http://gridlab-d.shoutwiki.com/wiki/Timezone">http://gridlab-d.shoutwiki.com/wiki/Timezone</a>. If you do not
wish to modify the timezone, set it to None.</p></li>
</ul>
</dd>
</dl>
<p>NOTE: Aside from type-checking, inputs are NOT validated.
NOTE: This method has certainly not been optimized. However,</p>
<blockquote>
<div><p>I’m going for convenient and readable rather than efficient.
Also avoiding over optimization for silly things.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.add_run_components">
<code class="sig-name descname">add_run_components</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">stoptime</span></em>, <em class="sig-param"><span class="n">timezone</span><span class="o">=</span><span class="default_value">'UTC0'</span></em>, <em class="sig-param"><span class="n">v_source</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">profiler</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">minimum_timestep</span><span class="o">=</span><span class="default_value">60</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.add_run_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Add components to make model runnable. This is CIM-specific.</p>
<p>When a .glm is requested from the platform (requested on the
configuration topic, with the configuration type being
‘GridLAB-D Base GLM’), it doesn’t have all the requisite
components required to actually run the model. This function
adds these components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starttime</strong> – datetime.datetime, gets passed directly to
add_or_modify_clock</p></li>
<li><p><strong>stoptime</strong> – see starttime.</p></li>
<li><p><strong>timezone</strong> – string, gets passed directly to
add_or_modify_clock.</p></li>
<li><p><strong>v_source</strong> – Voltage at swing bus. Must be number, string,
or None. If None, the nominal_voltage from the ‘substation’
object will be used.</p></li>
<li><p><strong>profiler</strong> – Whether or not to use the model profiler. 0/1.</p></li>
<li><p><strong>minimum_timestep</strong> – Minimum simulation timestep for running
the model. Should be an integer for simplicity.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.add_substation_meter">
<code class="sig-name descname">add_substation_meter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.add_substation_meter" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to add a meter object to the substation.</p>
<p>TODO: Handle multiple substations.
TODO: Hard-coding the use of “substation” objects could get us</p>
<blockquote>
<div><p>into trouble.</p>
</div></blockquote>
<dl class="simple">
<dt>TODO: This looping to figure out what’s connected is NASTY. This</dt><dd><p>class should be augmented to include a graph representation
of the model, such as from networkx.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.clear_all_triplex_loads">
<code class="sig-name descname">clear_all_triplex_loads</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.clear_all_triplex_loads" title="Permalink to this definition">¶</a></dt>
<dd><p>For all triplex loads in the model, remove all properties
in TRIPLEX_PARAMS constant.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.convert_switch_status_to_three_phase">
<code class="sig-name descname">convert_switch_status_to_three_phase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">banked</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.convert_switch_status_to_three_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure all multi-phase switches have their corresponding
phase_&lt;phase&gt;_state properties set.</p>
<p>Individual phase states will be based on the overall state
from the “status” property. E.g., a switch with phases ABCN and
a “status” of “CLOSED” will have phase_A_state “CLOSED” and the
same for B and C. The “status” property will be removed.</p>
<p>Additionally, switches will have their “operating_mode”
attributed modified according to the “banked” input to this
method.</p>
<p><a class="reference external" href="http://gridlab-d.shoutwiki.com/wiki/Power_Flow_User_Guide#Switch">GridLAB-D documentation</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>banked</strong> – If True, set all switch “operating_mode”s to
“BANKED.” Else, set to “INDIVIDUAL.”</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.find_object">
<code class="sig-name descname">find_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj_type</span></em>, <em class="sig-param"><span class="n">obj_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.find_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Find object by name in the model_map, if it exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>obj_type: type of the object to look up.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>obj_type: str</p>
</dd>
<dt class="field-odd">Param</dt>
<dd class="field-odd"><p>obj_name: name of the object to look up.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>obj_name: str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.get_items_by_type">
<code class="sig-name descname">get_items_by_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item_type</span></em>, <em class="sig-param"><span class="n">object_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.get_items_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Get data for all objects of the given type. At times, you
may want to use this instead of get_objects_by_type since the
return value is formatted differently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item_type</strong> – string, item type. At present (2019-07-03), 
valid item types appear to be ‘object’, ‘clock’, ‘module’,
or ‘object_unnamed’ by inspecting __init__ and
_map_model_dict.</p></li>
<li><p><strong>object_type</strong> – string, object type. Only used if item_type
is ‘object.’ E.g. ‘triplex_load’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Returns differ slightly by item_type. If the item_type 
is not present in the model, None will be returned. The 
other types are listed below:</p>
<blockquote>
<div><p>clock: Simply returns the clock dictionary.
module: Returns a dictionary of dictionaries keyed by</p>
<blockquote>
<div><p>module name.</p>
</div></blockquote>
<dl class="simple">
<dt>object: Dictionary of dictionaries keyed by object name.</dt><dd><p>NOTE: This is in contrast to get_objects_by_type 
which returns a list of dictionaries.</p>
</dd>
</dl>
<p>object_unnamed:</p>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.get_objects_by_type">
<code class="sig-name descname">get_objects_by_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">object_type</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.get_objects_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a listing of objects by type, e.g. ‘triplex_line.’</p>
<p>These will simply be looked up in the model_map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>object_type</strong> – string of desired object type to look up.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>object_list: list of dictionaries for the given object
type. Will return None if the object type isn’t in the
model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.loop_over_objects_helper">
<code class="sig-name descname">loop_over_objects_helper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">object_type</span></em>, <em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.loop_over_objects_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for looping over objects of a given type and doing
something with them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_type</strong> – Type of object to loop over, e.g. ‘switch’</p></li>
<li><p><strong>func</strong> – Function which each object will be passed to. The
first positional input should take an object of the given
type, which will be in dictionary format.</p></li>
<li><p><strong>args</strong> – Positional arguments to be passed to func.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be passed to func.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – if the given object_type is not present in
the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.modify_item">
<code class="sig-name descname">modify_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.modify_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify an item in the model. NOTE: The input item_dict will
be modified.</p>
<p>NOTE: this method CANNOT be used to change an object’s name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item_dict</strong> – Dictionary with attributes used for both
finding and modifying the item. E.g., for an object, both
the ‘object’ and ‘name’ fields are required to locate the
object. All other key/value pairs in the dictionary will
then be used to modify the item.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – if item_dict contains the ‘object’ key but
not the ‘name’ key.</p></li>
<li><p><strong>KeyError</strong> – if an object/item cannot be found.</p></li>
<li><p><strong>TypeError</strong> – if the type of the item cannot be identified
or the type of the item is not supported for modification.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None, the item in the model is modified directly.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.module_present">
<code class="sig-name descname">module_present</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">module_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.module_present" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if named module is present in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>module_name</strong> – Name of module, must be a string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.object_type_present">
<code class="sig-name descname">object_type_present</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">object_type</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.object_type_present" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect if a type of object (e.g. inverter) is present.</p>
<p>Returns True if the object_type is found, False otherwise.</p>
<p>NOTE: This only check in self.model_map[‘object’].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>object_type</strong> – string, object type to check for. Note
the validity of the object type will not be checked.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.remove_all_solar">
<code class="sig-name descname">remove_all_solar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.remove_all_solar" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all solar objects from the model.</p>
<dl class="simple">
<dt>TODO: If desired, this could be made general for all object</dt><dd><p>types.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.remove_item">
<code class="sig-name descname">remove_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.remove_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove item from both the model_dict and model_map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>item_dict</strong> – dictionary defining object to remove.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.remove_properties_from_item">
<code class="sig-name descname">remove_properties_from_item</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">item_dict</span></em>, <em class="sig-param"><span class="n">property_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.remove_properties_from_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove properties from an item.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.set_inverter_v_and_i">
<code class="sig-name descname">set_inverter_v_and_i</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.set_inverter_v_and_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Set V_In and I_In for all inverters such that the DC supply
is supplying the 110% inverter’s rated power.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.update_all_triplex_loads">
<code class="sig-name descname">update_all_triplex_loads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">triplex_loads</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.update_all_triplex_loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to update all the triplex loads in a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>triplex_loads</strong> – Dictionary of dictionaries, keyed by
name of each triplex_load object. The sub-dictionaries must
ONLY contain keys found in TRIPLEX_PARAMS. Note that the
dictionaries will not be validated (for speed), so be
careful.</p>
</dd>
</dl>
<dl class="simple">
<dt>NOTE/TODO: With very minimal effort this could be generalized</dt><dd><p>to work with any object type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.update_cap_switches">
<code class="sig-name descname">update_cap_switches</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cap_name</span></em>, <em class="sig-param"><span class="n">phase_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.update_cap_switches" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a capacitor’s switch positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cap_name</strong> – Name of the capacitor.</p></li>
<li><p><strong>phase_dict</strong> – Dictionary mapping of phases to states. E.g.,
{‘A’: ‘OPEN’, ‘B’: ‘CLOSED’, ‘C’: ‘OPEN}. Not all phases
must be present.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.update_reg_taps">
<code class="sig-name descname">update_reg_taps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reg_name</span></em>, <em class="sig-param"><span class="n">pos_dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.update_reg_taps" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a regulator’s tap positions, both in the regulator
object itself, as well as its configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reg_name</strong> – Name of the regulator in question.</p></li>
<li><p><strong>pos_dict</strong> – Dictionary mapping phases to positions. E.g.,
{‘A’: 12, ‘B’: 4, ‘C’: 16}. Not all phases must be present.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.glm.GLMManager.write_model">
<code class="sig-name descname">write_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out_path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.GLMManager.write_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to write out the model_dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>out_path</strong> – Full path to write model out to. If None, a
string will be returned.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyvvo.glm.ItemExistsError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.glm.</code><code class="sig-name descname">ItemExistsError</code><a class="headerlink" href="#pyvvo.glm.ItemExistsError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.glm.Error" title="pyvvo.glm.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.glm.Error</span></code></a></p>
<p>Raised when a GLMManager attempts to create a new item, but an
instance of that item already exists and must be unique. E.g.,
attempting to add a second clock to a model.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.glm.parse">
<code class="sig-prename descclassname">pyvvo.glm.</code><code class="sig-name descname">parse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_str</span></em>, <em class="sig-param"><span class="n">file_path</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a GLM into an omf.feeder tree. This is so we can walk the tree,
change things in bulk, etc.</p>
<p>Input can be a file path or GLM string.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.glm.sorted_write">
<code class="sig-prename descclassname">pyvvo.glm.</code><code class="sig-name descname">sorted_write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_tree</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.glm.sorted_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out a GLM from a tree, and order all tree objects by their key.</p>
<p>Sometimes GridLAB-D breaks if you rearrange a GLM.</p>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.gridappsd_platform">
<span id="gridappsd-platform-py"></span><h2>gridappsd_platform.py<a class="headerlink" href="#module-pyvvo.gridappsd_platform" title="Permalink to this headline">¶</a></h2>
<p>Module for interfacing with the GridAPPS-D platform.</p>
<p>Note this module depends on the GridAPPS-D platform being up and
running.</p>
<dl class="py exception">
<dt id="pyvvo.gridappsd_platform.Error">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">Error</code><a class="headerlink" href="#pyvvo.gridappsd_platform.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base class for exceptions in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="pyvvo.gridappsd_platform.PlatformManager">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">PlatformManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">60</span></em>, <em class="sig-param"><span class="n">stomp_log_level</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">goss_log_level</span><span class="o">=</span><span class="default_value">30</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.PlatformManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for interfacing with the GridAPPS-D platform API.</p>
<p>Note that this class is really intended for subscribing, etc. For
querying the Blazegraph database (with SPARQL queries), see
sparql.py</p>
<p>Connect to the GridAPPS-D platform by initializing a
gridappsd.GridAPPSD object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timeout</strong> – Timeout for GridAPPS-D API requests.</p></li>
<li><p><strong>stomp_log_level</strong> – Log level for stomp.py.</p></li>
<li><p><strong>goss_log_level</strong> – Log level for goss.py.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Initialized PlatformManager object.</p>
</dd>
</dl>
<dl class="py method">
<dt id="pyvvo.gridappsd_platform.PlatformManager.get_glm">
<code class="sig-name descname">get_glm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_id</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.PlatformManager.get_glm" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a model ID, get a GridLAB-D (.glm) model.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.gridappsd_platform.PlatformManager.get_simulation_output">
<code class="sig-name descname">get_simulation_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">simulation_id</span></em>, <em class="sig-param"><span class="n">query_measurement</span><span class="o">=</span><span class="default_value">'simulation'</span></em>, <em class="sig-param"><span class="n">starttime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">endtime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">measurement_mrid</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>List<span class="p">[</span>str<span class="p">]</span><span class="p">, </span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">index_by_time</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.PlatformManager.get_simulation_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple wrapper to call _query_simulation_output and then
parse and return the results. See the docstring of
_query_simulation_output for details on inputs.</p>
<p>TODO: document parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index_by_time</strong> – Passed to timeseries.parse_timeseries.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.gridappsd_platform.PlatformManager.get_weather">
<code class="sig-name descname">get_weather</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_time</span></em>, <em class="sig-param"><span class="n">end_time</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.PlatformManager.get_weather" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for querying weather data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_time</strong> – datetime.datetime object denoting the
beginning time of weather data to pull.</p></li>
<li><p><strong>end_time</strong> – “…” end time “…”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.gridappsd_platform.PlatformManager.run_simulation">
<code class="sig-name descname">run_simulation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">feeder_id</span></em>, <em class="sig-param"><span class="n">start_time</span></em>, <em class="sig-param"><span class="n">duration</span></em>, <em class="sig-param"><span class="n">realtime</span></em>, <em class="sig-param"><span class="n">applications</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">random_zip</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">houses</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">z_fraction</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">i_fraction</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">p_fraction</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">services</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">events</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.PlatformManager.run_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Start a simulation and return the simulation ID.</p>
<p>For now, this is hard-coded to the point where it’ll likely only
work with the 8500 and maybe 9500 node models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feeder_id</strong> – mrid of feeder to run simulation for.</p></li>
<li><p><strong>start_time</strong> – Python datetime for starting simulation.</p></li>
<li><p><strong>duration</strong> – Integer. Duration of simulation.</p></li>
<li><p><strong>realtime</strong> – Boolean. Whether or not to run the simulation
in real time.</p></li>
<li><p><strong>applications</strong> – List of dictionaries of applications to
run. Each application must at least have a ‘name’ field.</p></li>
<li><p><strong>random_zip</strong> – Boolean, whether to randomize zip loads.</p></li>
<li><p><strong>houses</strong> – Boolean, whether or not to use houses in the
simulation.</p></li>
<li><p><strong>z_fraction</strong> – Impedance fraction for loads.</p></li>
<li><p><strong>i_fraction</strong> – Current fraction for loads.</p></li>
<li><p><strong>p_fraction</strong> – Power fraction for loads.</p></li>
<li><p><strong>services</strong> – List of dictionaries of services to configure.
Check out
<a class="reference external" href="https://gridappsd-sensor-simulator.readthedocs.io/en/sensor-service-configuration/">https://gridappsd-sensor-simulator.readthedocs.io/en/sensor-service-configuration/</a>.</p></li>
<li><p><strong>events</strong> – <p>List of events. Each element should be a
dictionary with the following fields:</p>
<dl class="simple">
<dt>”message”: This should contain keys “forward_differences”</dt><dd><p>and “reverse_differences” as created by a gridappsd
DifferenceBuilder.</p>
</dd>
<dt>”event_type”: All I know of is the string</dt><dd><p>”ScheduledCommandEvent”</p>
</dd>
<dt>”occuredDateTime”: integer, seconds since the epoch when the</dt><dd><p>event will be applied (I suppose?).</p>
</dd>
<dt>”stopDateTime”: same as above, but when the event will be</dt><dd><p>undone (I suppose?).</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.gridappsd_platform.PlatformManager.send_command">
<code class="sig-name descname">send_command</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">object_ids</span></em>, <em class="sig-param"><span class="n">attributes</span></em>, <em class="sig-param"><span class="n">forward_values</span></em>, <em class="sig-param"><span class="n">reverse_values</span></em>, <em class="sig-param"><span class="n">sim_id</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.PlatformManager.send_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for sending a command into a running simulation.
This is partly a wrapper to DifferenceBuilder, but also sends
the command into the simulation.</p>
<p>Note all list parameters below must be 1:1. In other words,
object_ids[3] should correspond to attributes[3], etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_ids</strong> – List of mrids of objects to command.</p></li>
<li><p><strong>attributes</strong> – List of CIM attributes belonging to the
objects. These attributes are what we’re actually
commanding/changing.</p></li>
<li><p><strong>forward_values</strong> – List of new values for attributes.</p></li>
<li><p><strong>reverse_values</strong> – List of old (current) values for
attributes.</p></li>
<li><p><strong>sim_id</strong> – Simulation ID. If None, will attempt to use
self.sim.simulation_id. If that is also None, ValueError
will be raised.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary representing the message that gets sent in.
If no message will be sent (if input lists are empty),
returns None instead.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.gridappsd_platform.PlatformManager.wait_for_simulation">
<code class="sig-name descname">wait_for_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.PlatformManager.wait_for_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to block until the current simulation is complete, and
then update self.sim_complete to be None.</p>
<p>NOTE: This is not robust, and will hang if a simulation
crashes.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyvvo.gridappsd_platform.QueryReturnEmptyError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">QueryReturnEmptyError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">topic</span></em>, <em class="sig-param"><span class="n">query</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.QueryReturnEmptyError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.gridappsd_platform.Error" title="pyvvo.gridappsd_platform.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.gridappsd_platform.Error</span></code></a></p>
<p>Raised if a platform query for data returns empty.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>topic – Topic query was executed on.
query – Given query.
message – explanation of the error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="pyvvo.gridappsd_platform.SimOutRouter">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">SimOutRouter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">platform_manager</span></em>, <em class="sig-param"><span class="n">sim_id</span></em>, <em class="sig-param"><span class="n">fn_mrid_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.SimOutRouter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for listening and routing simulation output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>platform_manager</strong> – Initialized PlatformManager object.</p></li>
<li><p><strong>sim_id</strong> – Simulation ID on which to listen to.</p></li>
<li><p><strong>fn_mrid_list</strong> – <p>list of dictionaries of the form
{‘function’: &lt;function&gt;, ‘mrids’: [&lt;mrid1&gt;, &lt;mrid2&gt;,…],
‘kwargs’: {‘dict’: ‘of keyword args’,</p>
<blockquote>
<div><p>’to’: ‘pass to function’}}</p>
</div></blockquote>
<p>where ‘function’ can either be a function or class method
that will accept both a list of measurements as a positional
argument and ‘sim_dt’ (of type datetime.datetime) as a
keyword argument. The ‘mrids’ field is a list of mrids to
extract from the simulation output, which will correspond to
measurements. ‘kwargs’ is optional, and consists of key word
arguments to pass to the function.</p>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyvvo.gridappsd_platform.SimOutRouter.add_funcs_and_mrids">
<code class="sig-name descname">add_funcs_and_mrids</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.SimOutRouter.add_funcs_and_mrids" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to add functions and MRIDs to the router.
Implementation detail: functions will be stored as weak
references.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn_mrid_list</strong> – See description in __init__.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.gridappsd_platform.SimulationClock">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">SimulationClock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gad</span><span class="p">:</span> <span class="n">gridappsd.GridAPPSD</span></em>, <em class="sig-param"><span class="n">sim_id</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">sim_start_ts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">log_interval</span><span class="o">=</span><span class="default_value">60</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.SimulationClock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for keeping track of a simulation’s time as it progresses.</p>
<p>Initialize attributes, subscribe to the simulation log.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gad</strong> – Initialized gridappsd.GridAPPSD object.</p></li>
<li><p><strong>sim_id</strong> – Simulation ID of the simulation to track.</p></li>
<li><p><strong>sim_start_ts</strong> – Simulation start timestamp in seconds since
the epoch.</p></li>
<li><p><strong>log_interval</strong> – How many simulation seconds in between
logging the current simulation time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.gridappsd_platform.get_gad_address">
<code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">get_gad_address</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.get_gad_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to get GRIDAPPS-D address.</p>
<p>The address is different depending on whether we’re operating
inside or outside the platform.</p>
<p>TODO: logging</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.gridappsd_platform.get_gad_object">
<code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">get_gad_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.get_gad_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to get a GridAPPSD object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Passed directly to the GridAPPSD constructor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.gridappsd_platform.get_platform_env_var">
<code class="sig-prename descclassname">pyvvo.gridappsd_platform.</code><code class="sig-name descname">get_platform_env_var</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.gridappsd_platform.get_platform_env_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to get the ‘platform’ environment variable.</p>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.load_model">
<span id="load-model-py"></span><h2>load_model.py<a class="headerlink" href="#module-pyvvo.load_model" title="Permalink to this headline">¶</a></h2>
<p>Module for managing load modeling: take data from the platform,
manipulate it, then perform a ZIP fit.</p>
<dl class="py class">
<dt id="pyvvo.load_model.LoadModelManager">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.load_model.</code><code class="sig-name descname">LoadModelManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_nominal_voltage</span></em>, <em class="sig-param"><span class="n">load_measurements</span></em>, <em class="sig-param"><span class="n">load_names_glm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.LoadModelManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for managing our load models.</p>
<p>Map and filter the given data down to a single DataFrame with
relevant information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_nominal_voltage</strong> – Pandas DataFrame, should come from
sparql.SPARQLManager.query_load_nominal_voltage()</p></li>
<li><p><strong>load_measurements</strong> – Pandas DataFrame, should come from
sparql.SPARQLManager.query_load_measurements()</p></li>
<li><p><strong>load_names_glm</strong> – <p>List of strings of the triplex load names
within a GridLAB-D model. The simplest way to obtain this is
through a glm.GLMManager object (‘mgr’ in this example):
list(mgr.get_items_by_type(item_type=’object’,</p>
<blockquote>
<div><p>object_type=’triplex_load’).keys())</p>
</div></blockquote>
</p></li>
<li><p><strong>simulation_id</strong> – ID of simulation for which we’re managing
load models.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.fit_for_all">
<code class="sig-name descname">fit_for_all</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sim_id</span></em>, <em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">endtime</span></em>, <em class="sig-param"><span class="n">feeder_kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.fit_for_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.input_queue">
<em class="property">property </em><code class="sig-name descname">input_queue</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.input_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing JoinableQueue which provides input to the
_get_data_and_fit_worker method.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.load_df">
<em class="property">property </em><code class="sig-name descname">load_df</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.load_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas DataFrame with four columns: meas_type, meas_mrid,
eqid, and load_name.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.logging_queue">
<em class="property">property </em><code class="sig-name descname">logging_queue</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.logging_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing Queue where logging information from
_get_data_and_fit_worker is placed.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.logging_thread">
<em class="property">property </em><code class="sig-name descname">logging_thread</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.logging_thread" title="Permalink to this definition">¶</a></dt>
<dd><p>threading.Thread object targeted at _logging_worker.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.n_jobs">
<em class="property">property </em><code class="sig-name descname">n_jobs</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.n_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer number of processes/jobs to run.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.output_queue">
<em class="property">property </em><code class="sig-name descname">output_queue</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.output_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiprocessing Queue where output from
_get_data_and_fit_worker is placed.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.platform">
<em class="property">property </em><code class="sig-name descname">platform</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.platform" title="Permalink to this definition">¶</a></dt>
<dd><p>gridappsd_platform.PlatformManager object, intended for
getting weather data.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.load_model.LoadModelManager.processes">
<em class="property">property </em><code class="sig-name descname">processes</code><a class="headerlink" href="#pyvvo.load_model.LoadModelManager.processes" title="Permalink to this definition">¶</a></dt>
<dd><p>list of multiprocessing.Process objects, targeted at
_get_data_and_fit_worker.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyvvo.load_model.QueueFeeder">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.load_model.</code><code class="sig-name descname">QueueFeeder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_measurements</span><span class="p">:</span> <span class="n">pandas.DataFrame</span></em>, <em class="sig-param"><span class="n">simulation_id</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">data_queue</span><span class="p">:</span> <span class="n">multiprocessing.context.BaseContext.Queue</span></em>, <em class="sig-param"><span class="n">initial_n</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">subsequent_n</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">meas_per_load</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">starttime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">endtime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.QueueFeeder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to continuously feed a queue with historic load data
from the platform. After initialization, attach a thread to
the object’s “run” method. This class’s singular purpose is to
get load data from the platform and put it into a queue.
However, it does so in a way that is memory friendly - we don’t
go and ask for data for all loads at once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_measurements</strong> – DataFrame as would come from
sparql.SPARQLManager.query_load_measurements()</p></li>
<li><p><strong>simulation_id</strong> – </p></li>
<li><p><strong>data_queue</strong> – Multiprocessing queue to put data into.</p></li>
<li><p><strong>initial_n</strong> – Initial number of</p></li>
<li><p><strong>subsequent_n</strong> – </p></li>
<li><p><strong>meas_per_load</strong> – Number of measurements per load. Will always
be 4 for triplex loads (one VA and one PNV measurement per
phase).</p></li>
<li><p><strong>starttime</strong> – Passed directly to
gridappsd_platform.PlatformManager.get_simulation_output</p></li>
<li><p><strong>endtime</strong> – Passed directly to
gridappsd_platform.PlatformManager.get_simulation_output</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyvvo.load_model.QueueFeeder.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">15</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.QueueFeeder.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyvvo.load_model.fit_for_load">
<code class="sig-prename descclassname">pyvvo.load_model.</code><code class="sig-name descname">fit_for_load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_data</span></em>, <em class="sig-param"><span class="n">weather_data</span></em>, <em class="sig-param"><span class="n">selection_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prediction_datetime</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.fit_for_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine load and weather data, filter by time (day of week and
time of day), and then get a ZIP model by calling
pyvvo.zip.get_best_fit_from_clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_data</strong> – Pandas DataFrame. Return from get_data_for_load.</p></li>
<li><p><strong>weather_data</strong> – Pandas DataFrame which has originated from
gridappsd_platform.PlatformManager.get_weather. The data is
already assumed to be cleaned, e.g. it has already been passed
through timeseries.fix_ghi.</p></li>
<li><p><strong>selection_data</strong> – Pandas Series, used as the point in space to
which cluster distances are measured. Passed directly to
zip.get_best_fit_from_clustering. Note all values of the index
must be columns in either load_data or weather_data, and voltage
(‘v’) is not allowed. If None, the last ‘temperature’ and ‘ghi’
values after DataFrame merging and interpolation will be used.</p></li>
<li><p><strong>prediction_datetime</strong> – Optional. datetime.datetime object,
representing the starting time of the interval for which the
load model will be used to make predictions. If not provided,
it will be inferred from the last entry in either load_data or
weather_data, whichever has the later time.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>NOTE 1: It’s assumed that load_data and weather_data were pulled</dt><dd><p>using the same starting and ending times.</p>
</dd>
<dt>NOTE 2: These two DataFrames will be merged, and any resulting</dt><dd><p>NaN values will be filled by simple linear interpolation. Thus,
it’s the caller’s responsibility to ensure reasonable alignment
between the indices of the DataFrames.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>output from pyvvo.zip.get_best_fit_from_clustering.</p>
</dd>
</dl>
<dl>
<dt>TODO: Should this filtering and joining be moved? It seems like it</dt><dd><p>could be excessive to do this for every single load. Maybe it
would be better to create one big DataFrame with all the load
data?</p>
<p>Back of the napkin:
2000 loads * 15 minutes * 4 intervals/hour * 24 hour/day</p>
<blockquote>
<div><ul class="simple">
<li><p>7 days/week * 2 weeks * 3 parameters * 8 bytes/parameter</p></li>
<li><p>1 MB/1,000,000 bytes = 968 MB.</p></li>
</ul>
</div></blockquote>
<p>We may not want to suck that into memory. We could “chunk” it
somehow. Well, we’ll cross that bridge later.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.load_model.fix_load_name">
<code class="sig-prename descclassname">pyvvo.load_model.</code><code class="sig-name descname">fix_load_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.fix_load_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip quotes, remove prefix, and remove suffix from load names.</p>
<p>Load names in a GridLAB-D model from the platform are quoted and
start with a prefix when compared to the name in the CIM. Make the
GridLAB-D model version look like what’s in the CIM, but also
remove the one character suffix (which must be either ‘a’ or ‘b’).
The once character ‘a’/’b’ suffix does not have to be present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> – String, name for triplex load to be fixed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>n without quotes at the beginning or end, the
TRIPLEX_LOAD_PREFIX removed, and the one character (‘a’ or ‘b’)
suffix removed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.load_model.get_data_and_fit">
<code class="sig-prename descclassname">pyvvo.load_model.</code><code class="sig-name descname">get_data_and_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gdfl_kwargs</span></em>, <em class="sig-param"><span class="n">ffl_kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.get_data_and_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Get data via get_data_for_load, perform ZIP fit via fit_for_load.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gdfl_kwargs</strong> – Keyword arguments to pass to get_data_for_load.</p></li>
<li><p><strong>ffl_kwargs</strong> – Keyword arguments to pass to fit_for_load, except
load_data. The load_data comes from get_data_for_load.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result from calling fit_for_load. See that docstring for
more details.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.load_model.transform_data_for_load">
<code class="sig-prename descclassname">pyvvo.load_model.</code><code class="sig-name descname">transform_data_for_load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meas_data</span><span class="p">:</span> <span class="n">pandas.DataFrame</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.load_model.transform_data_for_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Given load measurement data from a QueueFeeder’s queue, combine
VA and PNV measurements as appropriate, create DataFrame with v,
p, and q for load modeling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meas_data</strong> – Pandas DataFrame which comes from a QueueFeeder.
It represents data for a SINGLE load over a given time
horizon. IMPORTANT: Right now, we’re assuming this is a
triplex load and simply summing PNV measurements for the
same timestamp and also summing VA measurements for the
same timestamp.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas DataFrame with three columns, ‘v’, ‘p’, and ‘q’.
Indexed by time as returned by
gridappsd_platform.PlatformManager.get_simulation_output.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.run_pyvvo">
<span id="run-pyvvo-py"></span><h2>run_pyvvo.py<a class="headerlink" href="#module-pyvvo.run_pyvvo" title="Permalink to this headline">¶</a></h2>
<p>Module for running PyVVO. This module is run by the platform (see
platform_config.json). The program expects two arguments: simulation ID
and simulation request.</p>
<p>Relevant documentation from GridAPPS-D can be found <a class="reference external" href="https://gridappsd.readthedocs.io/en/latest/using_gridappsd/index.html#id7">here</a>.
Since the link I gave you will almost definitely break or be wrong at
some point, it’s under “Using GridAPPS-D”/”Hosting Application” on the
GridAPPS-D <a class="reference external" href="https://gridappsd.readthedocs.io/en/latest/index.html">Read the Docs site</a></p>
</div>
<div class="section" id="module-pyvvo.sparql">
<span id="sparql-py"></span><h2>sparql.py<a class="headerlink" href="#module-pyvvo.sparql" title="Permalink to this headline">¶</a></h2>
<p>Module for querying and parsing SPARQL through GridAPPS-D</p>
<dl class="py exception">
<dt id="pyvvo.sparql.Error">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.sparql.</code><code class="sig-name descname">Error</code><a class="headerlink" href="#pyvvo.sparql.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base class for exceptions in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="pyvvo.sparql.SPARQLManager">
<em class="property">class </em><code class="sig-prename descclassname">pyvvo.sparql.</code><code class="sig-name descname">SPARQLManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">feeder_mrid</span></em>, <em class="sig-param"><span class="n">timeout</span><span class="o">=</span><span class="default_value">30</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for querying and parsing SPARQL in GridAPPS-D.</p>
<p>NOTE: While it’s usually conventional to have class constants
defined near the beginning of the class definition, we’ll be
defining them at the bottom since the SPARQL queries are huge.</p>
<dl class="simple">
<dt>TODO: Update query variables to be more reflective of what they are.</dt><dd><p>That’s what you get for copy + paste… What the hell is this?</p>
</dd>
<dt>TODO: Some query variables should probably be constants which can</dt><dd><p>be imported by other modules. This way, we can avoid looking
through test files or query strings, and just find a listing
of constants at the top.</p>
</dd>
</dl>
<p>Connect to the platform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feeder_mrid</strong> – unique identifier for the feeder in
question. Since PyVVO works on a per feeder basis, this is
required, and all queries will be executed for the specified
feeder.</p></li>
<li><p><strong>timeout</strong> – timeout for querying the blazegraph database.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.ALL_MEASUREMENTS_QUERY">
<code class="sig-name descname">ALL_MEASUREMENTS_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?class ?type ?name ?bus ?bus_mrid ?phases ?eqtype ?eqname ?eqid ?trmid ?id WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?eq c:Equipment.EquipmentContainer ?fdr.?fdr c:IdentifiedObject.mRID ?feeder_mrid.{{ ?s r:type c:Discrete. bind (&quot;Discrete&quot; as ?class)}} UNION {{ ?s r:type c:Analog. bind (&quot;Analog&quot; as ?class)}} ?s c:IdentifiedObject.name ?name .?s c:IdentifiedObject.mRID ?id .?s c:Measurement.PowerSystemResource ?eq .?s c:Measurement.Terminal ?trm .?s c:Measurement.measurementType ?type .?trm c:IdentifiedObject.mRID ?trmid.?eq c:IdentifiedObject.mRID ?eqid.?eq c:IdentifiedObject.name ?eqname.?eq r:type ?typeraw.bind(strafter(str(?typeraw),&quot;#&quot;) as ?eqtype)?trm c:Terminal.ConnectivityNode ?cn.?cn c:IdentifiedObject.name ?bus.?cn c:IdentifiedObject.mRID ?bus_mrid. ?s c:Measurement.phases ?phsraw .{{bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phases)}}}} ORDER BY ?class ?type ?name'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.ALL_MEASUREMENTS_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.CAPACITOR_QUERY">
<code class="sig-name descname">CAPACITOR_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?name ?basev ?nomu ?bsection ?bus ?conn ?grnd ?phase ?ctrlenabled ?discrete ?mode ?deadband ?setpoint ?delay ?monclass ?moneq ?monbus ?monphs ?mrid ?feeder_mrid WHERE {{ ?s r:type c:LinearShuntCompensator. VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?s c:Equipment.EquipmentContainer ?fdr. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. ?s c:IdentifiedObject.name ?name. ?s c:ConductingEquipment.BaseVoltage ?bv. ?bv c:BaseVoltage.nominalVoltage ?basev. ?s c:ShuntCompensator.nomU ?nomu. ?s c:LinearShuntCompensator.bPerSection ?bsection. ?s c:ShuntCompensator.phaseConnection ?connraw. bind(strafter(str(?connraw),&quot;PhaseShuntConnectionKind.&quot;) as ?conn) ?s c:ShuntCompensator.grounded ?grnd. OPTIONAL {{ ?scp c:ShuntCompensatorPhase.ShuntCompensator ?s. ?scp c:ShuntCompensatorPhase.phase ?phsraw. bind(strafter(str(?phsraw),&quot;SinglePhaseKind.&quot;) as ?phase) }} OPTIONAL {{ ?ctl c:RegulatingControl.RegulatingCondEq ?s. ?ctl c:RegulatingControl.discrete ?discrete. ?ctl c:RegulatingControl.enabled ?ctrlenabled. ?ctl c:RegulatingControl.mode ?moderaw. bind(strafter(str(?moderaw),&quot;RegulatingControlModeKind.&quot;) as ?mode) ?ctl c:RegulatingControl.monitoredPhase ?monraw. bind(strafter(str(?monraw),&quot;PhaseCode.&quot;) as ?monphs) ?ctl c:RegulatingControl.targetDeadband ?deadband. ?ctl c:RegulatingControl.targetValue ?setpoint. ?s c:ShuntCompensator.aVRDelay ?delay. ?ctl c:RegulatingControl.Terminal ?trm. ?trm c:Terminal.ConductingEquipment ?eq. ?eq a ?classraw. bind(strafter(str(?classraw),&quot;CIM100#&quot;) as ?monclass) ?eq c:IdentifiedObject.name ?moneq. ?trm c:Terminal.ConnectivityNode ?moncn. ?moncn c:IdentifiedObject.name ?monbus. }} ?s c:IdentifiedObject.mRID ?mrid. ?t c:Terminal.ConductingEquipment ?s. ?t c:Terminal.ConnectivityNode ?cn. ?cn c:IdentifiedObject.name ?bus }} ORDER by ?name '</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.CAPACITOR_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.CAPACITOR_STATUS_MEASUREMENT_QUERY">
<code class="sig-name descname">CAPACITOR_STATUS_MEASUREMENT_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?{cap_mrid} ?{meas_mrid} ?phase WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?eq c:Equipment.EquipmentContainer ?fdr.?fdr c:IdentifiedObject.mRID ?feeder_mrid.{{ ?s r:type c:Discrete. bind (&quot;Discrete&quot; as ?class)}} ?s c:IdentifiedObject.name ?name .?s c:IdentifiedObject.mRID ?{meas_mrid} .?s c:Measurement.PowerSystemResource ?eq .?s c:Measurement.Terminal ?trm .?s c:Measurement.measurementType ?type .?trm c:IdentifiedObject.mRID ?trmid.?eq c:IdentifiedObject.mRID ?{cap_mrid}.?eq r:type c:LinearShuntCompensator. ?eq r:type ?typeraw.bind(strafter(str(?typeraw),&quot;#&quot;) as ?eqtype)?trm c:Terminal.ConnectivityNode ?cn.?cn c:IdentifiedObject.name ?bus.?s c:Measurement.phases ?phsraw .{{bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phase)}}}} ORDER BY ?{cap_mrid}'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.CAPACITOR_STATUS_MEASUREMENT_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.INVERTER_MEASUREMENTS_QUERY">
<code class="sig-name descname">INVERTER_MEASUREMENTS_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?inverter_mrid ?meas_mrid ?phase ?meas_type WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} VALUES ?meas_type {{&quot;VA&quot;}} ?s r:type c:Analog. ?s c:Measurement.measurementType ?meas_type. ?s c:IdentifiedObject.mRID ?meas_mrid. ?s c:Measurement.PowerSystemResource ?eq. ?s c:Measurement.Terminal ?trm. ?s c:Measurement.phases ?phsraw. {{bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phase)}} .?eq c:IdentifiedObject.mRID ?inverter_mrid. ?eq r:type c:PowerElectronicsConnection. ?eq c:Equipment.EquipmentContainer ?fdr. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. }} ORDER BY ?inverter_mrid ?meas_type'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.INVERTER_MEASUREMENTS_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.INVERTER_QUERY">
<code class="sig-name descname">INVERTER_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?inverter_mrid ?inverter_name ?inverter_mode ?inverter_max_q ?inverter_min_q ?inverter_p ?inverter_q ?inverter_rated_s ?inverter_rated_u ?phase_mrid ?phase_name ?phase_p ?phase_q (group_concat(distinct ?phs;separator=&quot;\\n&quot;) as ?phases) WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?s r:type c:PowerElectronicsConnection. ?s c:Equipment.EquipmentContainer ?fdr. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. ?s c:IdentifiedObject.mRID ?inverter_mrid. ?s c:IdentifiedObject.name ?inverter_name. ?s c:PowerElectronicsConnection.p ?inverter_p. ?s c:PowerElectronicsConnection.q ?inverter_q. ?s c:PowerElectronicsConnection.ratedS ?inverter_rated_s. ?s c:PowerElectronicsConnection.ratedU ?inverter_rated_u. OPTIONAL {{ ?s c:PowerElectronicsConnection.inverterMode ?inverter_mode. ?s c:PowerElectronicsConnection.maxQ ?inverter_max_q. ?s c:PowerElectronicsConnection.minQ ?inverter_min_q. }} OPTIONAL {{ ?pecp c:PowerElectronicsConnectionPhase.PowerElectronicsConnection ?s. ?pecp c:IdentifiedObject.mRID ?phase_mrid. ?pecp c:IdentifiedObject.name ?phase_name. ?pecp c:PowerElectronicsConnectionPhase.p ?phase_p. ?pecp c:PowerElectronicsConnectionPhase.q ?phase_q. ?pecp c:PowerElectronicsConnectionPhase.phase ?phsraw bind(strafter(str(?phsraw),&quot;SinglePhaseKind.&quot;) as ?phs) }} }} GROUP BY ?inverter_mrid ?inverter_name ?inverter_rated_s ?inverter_rated_u ?inverter_p ?inverter_q ?phase_mrid ?phase_name ?phase_p ?phase_q ?inverter_mode ?inverter_max_q ?inverter_min_q ORDER BY ?inverter_mrid'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.INVERTER_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.LOAD_MEASUREMENTS_QUERY">
<code class="sig-name descname">LOAD_MEASUREMENTS_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?class ?type ?name ?node ?phases ?load ?eqid ?trmid ?id WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?eq c:Equipment.EquipmentContainer ?fdr. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. {{ ?s r:type c:Discrete. bind (&quot;Discrete&quot; as ?class)}} UNION {{ ?s r:type c:Analog. bind (&quot;Analog&quot; as ?class)}} ?s c:IdentifiedObject.name ?name . ?s c:IdentifiedObject.mRID ?id . ?s c:Measurement.PowerSystemResource ?eq . ?s c:Measurement.Terminal ?trm . ?s c:Measurement.measurementType ?type . ?trm c:IdentifiedObject.mRID ?trmid. ?eq c:IdentifiedObject.mRID ?eqid. ?eq c:IdentifiedObject.name ?load. ?eq r:type c:EnergyConsumer. ?trm c:Terminal.ConnectivityNode ?cn. ?cn c:IdentifiedObject.name ?node. ?s c:Measurement.phases ?phsraw . {{bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phases)}} }} ORDER BY ?load ?class ?type ?name '</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.LOAD_MEASUREMENTS_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.LOAD_NOMINAL_VOLTAGE_QUERY">
<code class="sig-name descname">LOAD_NOMINAL_VOLTAGE_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?name ?bus ?basev ?conn (group_concat(distinct ?phs;separator=&quot;,&quot;) as ?phases) WHERE {{ ?s r:type c:EnergyConsumer. VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?s c:Equipment.EquipmentContainer ?fdr. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. ?s c:IdentifiedObject.name ?name. ?s c:ConductingEquipment.BaseVoltage ?bv. ?bv c:BaseVoltage.nominalVoltage ?basev. ?s c:EnergyConsumer.phaseConnection ?connraw. bind(strafter(str(?connraw),&quot;PhaseShuntConnectionKind.&quot;) as ?conn) OPTIONAL {{ ?ecp c:EnergyConsumerPhase.EnergyConsumer ?s. ?ecp c:EnergyConsumerPhase.phase ?phsraw. bind(strafter(str(?phsraw),&quot;SinglePhaseKind.&quot;) as ?phs) }} ?t c:Terminal.ConductingEquipment ?s. ?t c:Terminal.ConnectivityNode ?cn. ?cn c:IdentifiedObject.name ?bus }} GROUP BY ?name ?bus ?basev ?p ?q ?conn ORDER by ?name '</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.LOAD_NOMINAL_VOLTAGE_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.MEASUREMENTS_FOR_BUS_QUERY">
<code class="sig-name descname">MEASUREMENTS_FOR_BUS_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?class ?type ?name ?bus ?bus_mrid ?phases ?eqtype ?eqname ?eqid ?trmid ?id WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?eq c:Equipment.EquipmentContainer ?fdr.?fdr c:IdentifiedObject.mRID ?feeder_mrid.{{ ?s r:type c:Discrete. bind (&quot;Discrete&quot; as ?class)}} UNION {{ ?s r:type c:Analog. bind (&quot;Analog&quot; as ?class)}} ?s c:IdentifiedObject.name ?name .?s c:IdentifiedObject.mRID ?id .?s c:Measurement.PowerSystemResource ?eq .?s c:Measurement.Terminal ?trm .?s c:Measurement.measurementType ?type .?trm c:IdentifiedObject.mRID ?trmid.?eq c:IdentifiedObject.mRID ?eqid.?eq c:IdentifiedObject.name ?eqname.?eq r:type ?typeraw.bind(strafter(str(?typeraw),&quot;#&quot;) as ?eqtype)?trm c:Terminal.ConnectivityNode ?cn.?cn c:IdentifiedObject.name ?bus.?cn c:IdentifiedObject.mRID &quot;{bus_mrid}&quot;. ?s c:Measurement.phases ?phsraw .{{bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phases)}}}} ORDER BY ?class ?type ?name'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.MEASUREMENTS_FOR_BUS_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.PREFIX">
<code class="sig-name descname">PREFIX</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\n'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.PREFIX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.REGULATOR_QUERY">
<code class="sig-name descname">REGULATOR_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?ltc_flag ?mrid ?name ?phase ?step_voltage_increment ?control_mode ?enabled ?high_step ?low_step ?neutral_step ?step ?tap_changer_mrid WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?pxf c:Equipment.EquipmentContainer ?fdr. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. ?tap_changer r:type c:RatioTapChanger. ?tap_changer c:RatioTapChanger.TransformerEnd ?end. OPTIONAL {{ ?end c:TransformerTankEnd.phases ?phsraw. bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phase)}} ?end c:TransformerTankEnd.TransformerTank ?tank. ?tank c:TransformerTank.PowerTransformer ?pxf. ?pxf c:IdentifiedObject.name ?name. ?pxf c:IdentifiedObject.mRID ?mrid. ?tap_changer c:RatioTapChanger.stepVoltageIncrement ?step_voltage_increment. ?tap_changer c:IdentifiedObject.mRID ?tap_changer_mrid. ?tap_changer c:TapChanger.controlEnabled ?control_enabled. ?tap_changer c:TapChanger.highStep ?high_step. ?tap_changer c:TapChanger.lowStep ?low_step. ?tap_changer c:TapChanger.ltcFlag ?ltc_flag. ?tap_changer c:TapChanger.neutralStep ?neutral_step. ?tap_changer c:TapChanger.step ?step. ?tap_changer c:TapChanger.TapChangerControl ?ctl. ?ctl c:RegulatingControl.enabled ?enabled. ?ctl c:RegulatingControl.mode ?ctlmoderaw. bind(strafter(str(?ctlmoderaw),&quot;RegulatingControlModeKind.&quot;) as ?control_mode) ?asset c:Asset.PowerSystemResources ?tap_changer. }} ORDER BY ?name ?rname '</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.REGULATOR_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.RTC_POSITION_MEASUREMENT_QUERY">
<code class="sig-name descname">RTC_POSITION_MEASUREMENT_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?{reg_mrid} ?{meas_mrid} WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} VALUES ?type {{&quot;Pos&quot;}}?eq c:Equipment.EquipmentContainer ?fdr.?fdr c:IdentifiedObject.mRID ?feeder_mrid.{{ ?s r:type c:Discrete. }} ?s c:IdentifiedObject.name ?name .?s c:IdentifiedObject.mRID ?{meas_mrid} .?s c:Measurement.PowerSystemResource ?eq .?s c:Measurement.Terminal ?trm .?s c:Measurement.measurementType ?type .?eq c:IdentifiedObject.mRID ?eqid.?eq r:type c:PowerTransformer. ?tap_changer r:type c:RatioTapChanger. ?tap_changer c:IdentifiedObject.mRID ?{reg_mrid}. ?tap_changer c:RatioTapChanger.TransformerEnd ?end. ?end c:TransformerTankEnd.TransformerTank ?tank. ?tank c:TransformerTank.PowerTransformer ?eq. ?end c:TransformerTankEnd.phases ?endphsraw. ?s c:Measurement.phases ?measphsraw .FILTER(?endphsraw = ?measphsraw) }} ORDER BY ?{reg_mrid}'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.RTC_POSITION_MEASUREMENT_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.SUBSTATION_SOURCE_QUERY">
<code class="sig-name descname">SUBSTATION_SOURCE_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?name ?mrid ?bus ?bus_mrid ?basev ?nomv WHERE {{ ?s r:type c:EnergySource. VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?s c:Equipment.EquipmentContainer ?fdr. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. ?s c:IdentifiedObject.name ?name. ?s c:IdentifiedObject.mRID ?mrid. ?s c:ConductingEquipment.BaseVoltage ?bv. ?bv c:BaseVoltage.nominalVoltage ?basev. ?s c:EnergySource.nominalVoltage ?nomv. ?t c:Terminal.ConductingEquipment ?s. ?t c:Terminal.ConnectivityNode ?cn. ?cn c:IdentifiedObject.name ?bus. ?cn c:IdentifiedObject.mRID ?bus_mrid }} ORDER by ?name'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.SUBSTATION_SOURCE_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.SWITCHES_QUERY">
<code class="sig-name descname">SWITCHES_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?name ?mrid (group_concat(distinct ?phs;separator=&quot;&quot;) as ?phase) WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}}. VALUES ?cimraw {{c:LoadBreakSwitch c:Recloser c:Breaker}}. ?fdr c:IdentifiedObject.mRID ?feeder_mrid. ?s c:Equipment.EquipmentContainer ?fdr. ?s r:type ?cimraw. ?s c:IdentifiedObject.name ?name. ?s c:IdentifiedObject.mRID ?mrid. OPTIONAL {{ ?swp c:SwitchPhase.Switch ?s. ?swp c:SwitchPhase.phaseSide1 ?phsraw. bind(strafter(str(?phsraw),&quot;SinglePhaseKind.&quot;) as ?phs). }}}} GROUP BY ?name ?mrid ?phase ORDER BY ?mrid '</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.SWITCHES_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.SWITCH_STATUS_QUERY">
<code class="sig-name descname">SWITCH_STATUS_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\nSELECT ?{switch_mrid} ?{meas_mrid} ?phase WHERE {{ VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} ?eq c:Equipment.EquipmentContainer ?fdr.?fdr c:IdentifiedObject.mRID ?feeder_mrid.{{ ?s r:type c:Discrete. }} ?s r:type ?type . ?s c:IdentifiedObject.mRID ?{meas_mrid} . ?s c:Measurement.PowerSystemResource ?eq . ?s c:Measurement.Terminal ?trm . ?s c:Measurement.phases ?phsraw . {{bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phase)}} . ?eq c:IdentifiedObject.mRID ?{switch_mrid} . ?eq r:type c:LoadBreakSwitch . }} ORDER BY ?{switch_mrid}'</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.SWITCH_STATUS_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.SYNCH_MACH_MEAS_QUERY">
<code class="sig-name descname">SYNCH_MACH_MEAS_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\n\n        SELECT ?mach_mrid ?meas_mrid ?phase ?meas_type\n        WHERE {{\n            VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}}\n            VALUES ?meas_type {{&quot;VA&quot;}}\n            ?s r:type c:Analog.\n            ?s c:Measurement.measurementType ?meas_type.\n            ?s c:IdentifiedObject.mRID ?meas_mrid.\n            ?s c:Measurement.PowerSystemResource ?eq.\n            ?s c:Measurement.Terminal ?trm.\n            ?s c:Measurement.phases ?phsraw.\n            {{bind(strafter(str(?phsraw),&quot;PhaseCode.&quot;) as ?phase)}}.\n            ?eq c:IdentifiedObject.mRID ?mach_mrid.\n            ?eq r:type c:SynchronousMachine.\n            ?eq c:Equipment.EquipmentContainer ?fdr.\n            ?fdr c:IdentifiedObject.mRID ?feeder_mrid.\n        }}\n        ORDER BY ?mach_mrid ?meas_type\n        '</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.SYNCH_MACH_MEAS_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyvvo.sparql.SPARQLManager.SYNCH_MACH_QUERY">
<code class="sig-name descname">SYNCH_MACH_QUERY</code><em class="property"> = 'PREFIX r: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;\nPREFIX c: &lt;http://iec.ch/TC57/CIM100#&gt;\nPREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;\n\n        \n        SELECT ?mrid ?name ?rated_s ?rated_u ?p ?q ?phase\n        WHERE {{\n            VALUES ?feeder_mrid {{&quot;{feeder_mrid}&quot;}} \n            ?s r:type c:SynchronousMachine.\n            ?s c:IdentifiedObject.name ?name.\n            ?s c:Equipment.EquipmentContainer ?fdr.\n            ?fdr c:IdentifiedObject.mRID ?feeder_mrid.\n            ?s c:SynchronousMachine.ratedS ?rated_s.\n            ?s c:SynchronousMachine.ratedU ?rated_u.\n            ?s c:SynchronousMachine.p ?p.\n            ?s c:SynchronousMachine.q ?q. \n            bind(strafter(str(?s),&quot;#&quot;) as ?mrid).\n            OPTIONAL {{\n                ?smp c:SynchronousMachinePhase.SynchronousMachine ?s.\n                ?smp c:SynchronousMachinePhase.phase ?phsraw.\n                bind(strafter(str(?phsraw),&quot;SinglePhaseKind.&quot;) as ?phase)\n            }}\n        }}\n        GROUP BY ?mrid ?name ?rated_s ?rated_u ?p ?q ?phase\n        ORDER BY ?mrid\n        '</em><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.SYNCH_MACH_QUERY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_all_measurements">
<code class="sig-name descname">query_all_measurements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_all_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Query all measurements in a model.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_capacitor_measurements">
<code class="sig-name descname">query_capacitor_measurements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_capacitor_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Query status measurements attached to capacitors.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_capacitors">
<code class="sig-name descname">query_capacitors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_capacitors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information on capacitors in the feeder.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_inverter_measurements">
<code class="sig-name descname">query_inverter_measurements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_inverter_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Get measurements associated with inverters.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_inverters">
<code class="sig-name descname">query_inverters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_inverters" title="Permalink to this definition">¶</a></dt>
<dd><p>Get inverter attributes.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_load_measurements">
<code class="sig-name descname">query_load_measurements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_load_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Get measurement objects attached to EnergyConsumers (loads).</p>
<p>Note that each load may have multiple measurements.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_load_nominal_voltage">
<code class="sig-name descname">query_load_nominal_voltage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_load_nominal_voltage" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the nominal voltage for EnergyConsumers (loads).</p>
<p>The values are not altered, so division by sqrt(3) will need to
happen later.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_measurements_for_bus">
<code class="sig-name descname">query_measurements_for_bus</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bus_mrid</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_measurements_for_bus" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all measurements with a specific parent bus.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_regulators">
<code class="sig-name descname">query_regulators</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_regulators" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information on capacitors in the feeder.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_rtc_measurements">
<code class="sig-name descname">query_rtc_measurements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_rtc_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Query measurements attached to ratio tap changers.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_substation_source">
<code class="sig-name descname">query_substation_source</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_substation_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the substation source information.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_switch_measurements">
<code class="sig-name descname">query_switch_measurements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_switch_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Query status measurements attached to switches.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_switches">
<code class="sig-name descname">query_switches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_switches" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_synchronous_machine_measurements">
<code class="sig-name descname">query_synchronous_machine_measurements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_synchronous_machine_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Get VA measurements associated with synchronous machines.</p>
</dd></dl>

<dl class="py method">
<dt id="pyvvo.sparql.SPARQLManager.query_synchronous_machines">
<code class="sig-name descname">query_synchronous_machines</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLManager.query_synchronous_machines" title="Permalink to this definition">¶</a></dt>
<dd><p>Get synchronous machines. For now, assume they’re generators.</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyvvo.sparql.SPARQLQueryError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.sparql.</code><code class="sig-name descname">SPARQLQueryError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query</span></em>, <em class="sig-param"><span class="n">message</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLQueryError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.sparql.Error" title="pyvvo.sparql.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.sparql.Error</span></code></a></p>
<p>Raised if a SPARQL query returns an error.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>query – SPARQL query that resulted in error.
message – explanation of the error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt id="pyvvo.sparql.SPARQLQueryReturnEmptyError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.sparql.</code><code class="sig-name descname">SPARQLQueryReturnEmptyError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query</span></em>, <em class="sig-param"><span class="n">message</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.sparql.SPARQLQueryReturnEmptyError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.sparql.Error" title="pyvvo.sparql.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.sparql.Error</span></code></a></p>
<p>Raised if a SPARQL query returns empty bindings.</p>
<dl class="simple">
<dt>Attributes:</dt><dd><p>query – SPARQL query that resulted in empty return.
message – explanation of the error.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.timeseries">
<span id="timeseries-py"></span><h2>timeseries.py<a class="headerlink" href="#module-pyvvo.timeseries" title="Permalink to this headline">¶</a></h2>
<p>Module for handling timeseries data from the platform.
<a class="reference external" href="https://gridappsd.readthedocs.io/en/latest/using_gridappsd/index.html#timeseries-api">https://gridappsd.readthedocs.io/en/latest/using_gridappsd/index.html#timeseries-api</a></p>
<dl class="py function">
<dt id="pyvvo.timeseries.filter_by_time">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">filter_by_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">t_start</span></em>, <em class="sig-param"><span class="n">t_end</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.filter_by_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter data to get specific time intervals. Specifically, the
data will be filtered such that:
t_start &lt;= data.index.time &lt;= t_end</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Pandas DataFrame or Timeseries indexed by time.</p></li>
<li><p><strong>t_start</strong> – datetime.time object for the start of filtering.</p></li>
<li><p><strong>t_end</strong> – datetime.time object for the end of filtering.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.filter_by_weekday">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">filter_by_weekday</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.filter_by_weekday" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to call filter_by_day_of week to get weekdays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – pandas DataFrame or Timeseries indexed by time.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the subset of data which occurs on weekdays.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.filter_by_weekend">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">filter_by_weekend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.filter_by_weekend" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to call filter_by_day_of_week to get weekend days.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – pandas DataFrame or Timeseries indexed by time.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the subset of data which occurs on weekends.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.fix_ghi">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">fix_ghi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weather_data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.fix_ghi" title="Permalink to this definition">¶</a></dt>
<dd><p>The weather data can have negative GHI values, which is not
sensible. Zero them out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>weather_data</strong> – DataFrame from calling parse_weather. Must have
a ‘ghi’ column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.is_weekday">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">is_weekday</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.is_weekday" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicate if datetime object represents a weekday (True) or not
(False).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> – datetime.datetime like object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if dt represents a weekday, False if dt represents a
weekend.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.parse_timeseries">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">parse_timeseries</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">index_by_time</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.parse_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to parse platform timeseries data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – dictionary with results from calling the timeseries
API (either for weather data or simulation data). Ultimately,
this is a return from gridappsd.GridAPPSD.get_response.</p></li>
<li><p><strong>index_by_time</strong> – Boolean, whether or not to return data
indexed by time. You may want to set this to false if the
data has multiple entries for a single time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas DataFrame representing the data. Data types in
NUMERIC_COLS will be cast to np.float. Note NaNs may be present.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.parse_weather">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">parse_weather</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.parse_weather" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to parse the ridiculous platform weather data return.</p>
<p>For the journal paper, we used “solar_flux” from GridLAB-D. It seems
simplest here to use the “global” irradiance, which is the sum of
direct and diffuse irradiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – dictionary passed directly from
gridappsd_platform.PlatformManager.get_weather</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.resample_timeseries">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">resample_timeseries</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ts</span></em>, <em class="sig-param"><span class="n">interval_str</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.resample_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample timeseries, either up-sampling or down-sampling. For
up-sampling, linear interpolation will be used, and means will be
used for down-sampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – DataFrame or Series indexed by time.</p></li>
<li><p><strong>interval_str</strong> – <p>String representing the new desired interval.
Docs:
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects</a>
Examples:</p>
<blockquote>
<div><p>’15Min’
‘3S’</p>
</div></blockquote>
</p></li>
<li><p><strong>method</strong> – String, either ‘upsample’ or ‘downsample’. Only use
this parameter (make it None) if ts does not have a regular
interval, making it difficult to infer if we’re upsampling or
downsampling.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.timeseries.up_or_down_sample">
<code class="sig-prename descclassname">pyvvo.timeseries.</code><code class="sig-name descname">up_or_down_sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orig_interval</span></em>, <em class="sig-param"><span class="n">new_interval</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.timeseries.up_or_down_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to determine if upsampling or downsampling needs
performed given two frequency strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orig_interval</strong> – str, representing a Pandas dateoffset.</p></li>
<li><p><strong>new_interval</strong> – str, representing a Pandas dateoffset.</p></li>
</ul>
</dd>
</dl>
<p>Docs:
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects</a></p>
<p>Examples: ‘1Min’, ‘10S’</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>‘upsample’, ‘downsample’, or None (if the intervals are
equal)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.utils">
<span id="utils-py"></span><h2>utils.py<a class="headerlink" href="#module-pyvvo.utils" title="Permalink to this headline">¶</a></h2>
<p>Miscellaneous utility functions for pyvvo</p>
<dl class="py exception">
<dt id="pyvvo.utils.Error">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">Error</code><a class="headerlink" href="#pyvvo.utils.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Top level exception for utils.</p>
</dd></dl>

<dl class="py exception">
<dt id="pyvvo.utils.FunctionTimeoutError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">FunctionTimeoutError</code><a class="headerlink" href="#pyvvo.utils.FunctionTimeoutError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.utils.Error" title="pyvvo.utils.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.utils.Error</span></code></a></p>
<p>Exception raised by the time_limit context manager.</p>
</dd></dl>

<dl class="py exception">
<dt id="pyvvo.utils.LockTimeoutError">
<em class="property">exception </em><code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">LockTimeoutError</code><a class="headerlink" href="#pyvvo.utils.LockTimeoutError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyvvo.utils.Error" title="pyvvo.utils.Error"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyvvo.utils.Error</span></code></a></p>
<p>Raised if a call to a threading.Lock object’s acquire method
time out. Specifically, this is raised in wait_for_lock.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.add_timedelta_to_time">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">add_timedelta_to_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">td</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.add_timedelta_to_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a timedelta object to a time object using a dummy datetime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> – datetime.time object.</p></li>
<li><p><strong>td</strong> – datetime.timedelta object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>datetime.time object, representing the result of t + td.</p>
</dd>
</dl>
<p>NOTE: Using a gigantic td may result in an overflow. You’ve been
warned.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.drain_queue">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">drain_queue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.drain_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to simply clear out a queue. The items in the queue will
be discarded. If the queue is joinable (has a task_done() method),
it will be called for each get_nowait() call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>q</strong> – A queue.Queue lik object (e.g.
multiprocessing.JoinableQueue)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.dt_to_s_from_epoch">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">dt_to_s_from_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.dt_to_s_from_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert datetime.datetime object to seconds since the epoch as
a string.
:param dt: Python datetime.datetime object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>seconds since the epoch as a string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.dt_to_us_from_epoch">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">dt_to_us_from_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.dt_to_us_from_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert datetime.datetime object to microseconds since the epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> – datetime.datetime object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>microseconds since the epoch as a string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.dump_queue">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">dump_queue</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">i</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.dump_queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to empty a queue into a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> – A queue.Queue like object (e.g.
multiprocessing.JoinableQueue)</p></li>
<li><p><strong>i</strong> – A list object, for which items from q will be appended to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="lowerroman simple">
<li><p>While this isn’t necessary, it’s explicit.</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.get_complex">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">get_complex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">phi</span></em>, <em class="sig-param"><span class="n">degrees</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.get_complex" title="Permalink to this definition">¶</a></dt>
<dd><p>Given polar coordinates, return complex numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – radius/magnitude. Scalar or numpy array.</p></li>
<li><p><strong>phi</strong> – angle. Scalar or numpy array. Assumed to be in degrees
if degrees=True, otherwise assumed to be in radians.</p></li>
<li><p><strong>degrees</strong> – boolean, True for degrees, False for radians.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.gld_installed">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">gld_installed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.gld_installed" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if GridLAB-D is installed or not.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.list_to_string">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">list_to_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_list</span></em>, <em class="sig-param"><span class="n">conjunction</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.list_to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple helper for formatting lists contaings strings as strings.</p>
<p>This is intended for simple lists that contain strings. Input will
not be checked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_list</strong> – List to be converted to a string.</p></li>
<li><p><strong>conjunction</strong> – String - conjunction to be used (e.g. and, or).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.map_dataframe_columns">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">map_dataframe_columns</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map</span></em>, <em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">cols</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.map_dataframe_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to apply a map to specified columns in a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – valid input to pandas.Series.map.</p></li>
<li><p><strong>df</strong> – pandas DataFrame.</p></li>
<li><p><strong>cols</strong> – list of columns in ‘df’ to apply ‘map’ to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.parse_complex_str">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">parse_complex_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.parse_complex_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a string representing a complex number.</p>
<p>Specifically designed to work with various types of output from
GridLAB-D.</p>
<p>Raises a ValueError if string cannot be cast to a complex number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> – string representing a complex number. Examples:
+12.34-1.2j VA
+15-20d V
+12-3.14r I</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>complex number, unit associated with it.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.platform_header_timestamp_to_dt">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">platform_header_timestamp_to_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timestamp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.platform_header_timestamp_to_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert timestamp (milliseconds from epoch) to datetime object.
This is specifically built for reading the ‘timestamp’ field of the
header which comes in from the GridAPPS-D platform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timestamp</strong> – Integer or float. Milliseconds since
1970-01-01 00:00:00.000. Assumed to be in UTC.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dt: timezone aware (UTC) datetime.datetime object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.power_factor">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">power_factor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#pyvvo.utils.power_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a numpy array of complex values, compute power factor.
If the power factor is lagging, a positive value will be returned.
If the power factor is leading, a negative value will be returned.</p>
<p>Reference:</p>
<p>Power System Analysis and Design, 5th Edition, by Glover, Sarma, and
Overbye</p>
<p>In Section 2.2, power factor is defined as
<span class="math notranslate nohighlight">\(\cos (\delta - \beta)\)</span> where <span class="math notranslate nohighlight">\(\delta - \beta\)</span> is
the angle between the voltage and current. If
<span class="math notranslate nohighlight">\(\beta &lt; \delta\)</span>, then the power factor is lagging. If
<span class="math notranslate nohighlight">\(\beta &gt; \delta\)</span>, then the power factor is leading.
The power factor is positive by convention. If
<span class="math notranslate nohighlight">\(|\delta - \beta| &gt; \pi/2\)</span>, then the reference direction
for the current may be reversed, resulting in a positive value of
<span class="math notranslate nohighlight">\(\cos (\delta - \beta)\)</span>.</p>
<p>In the case where the reference direction of current is reversed,
we’ll simply rotate our complex number by 180 degrees.</p>
<p>Note that any 0-valued power factors will be converted to np.nan
and a warning will be logged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> – numpy.ndarray of complex values representing apparent
power (VA).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of power factor values. Value will be negative
if leading, positive if lagging. Any 0’s will be changed to
np.nan.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.read_config">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">read_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.read_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Simpler helper to read the PyVVO configuration file.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.read_gld_csv">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">read_gld_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.read_gld_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a .csv file from a GridLAB-D recorder into a DataFrame.</p>
<p>NOTE: No time parsing/indexing will be attempted, as this isn’t
presently needed.</p>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.run_gld">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">run_gld</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_path</span></em>, <em class="sig-param"><span class="n">env</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.run_gld" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper to run a GRIDLAB-D model. The GridLAB-D executable will be
run from the same directory as the model.</p>
<p>If needed, run options can be added in the future.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> – path (preferably full path) to GridLAB-D model.</p></li>
<li><p><strong>env</strong> – used to override the environment for subprocess. Leave
this as None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A subprocess.CompletedProcess object corresponding to the
GridLAB-D run.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.simulation_output_timestamp_to_dt">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">simulation_output_timestamp_to_dt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">timestamp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.simulation_output_timestamp_to_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert timestamp (seconds from epoch) to datetime object.
This is specifically built for reading the ‘timestamp’ field of the
message object which comes from the GridAPPS-D simulator output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timestamp</strong> – Integer or float. Seconds since
1970-01-01 00:00:00.000. Assumed to be in UTC.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dt: timezone aware (UTC) datetime.datetime object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.time_limit">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">time_limit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seconds</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.time_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager to run code with a timeout.</p>
<p>Source: <a class="reference external" href="https://stackoverflow.com/a/601168/11052174">https://stackoverflow.com/a/601168/11052174</a></p>
<dl class="simple">
<dt>Caveats:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Some S.O. users have noted that signals and threads don’t</dt><dd><p>mix well.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Not all functions can be interrupted by signals:</dt><dd><p><a class="reference external" href="https://stackoverflow.com/a/34895076/11052174">https://stackoverflow.com/a/34895076/11052174</a></p>
</dd>
</dl>
</li>
<li><p>If alarms are being used elsewhere, this may be a problem.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seconds</strong> – Integer number of seconds allowed before a
FunctionTimeoutError is raised.</p></li>
<li><p><strong>msg</strong> – Message to provide if a FunctionTimeoutError is
raised.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyvvo.utils.FunctionTimeoutError" title="pyvvo.utils.FunctionTimeoutError"><strong>FunctionTimeoutError</strong></a> – Raised if code doesn’t complete within
seconds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.utils.wait_for_lock">
<code class="sig-prename descclassname">pyvvo.utils.</code><code class="sig-name descname">wait_for_lock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.utils.wait_for_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for class methods which use a Lock object from the
threading module. The attribute must be named _lock.</p>
<p>The SimOutRouter (gridappsd_platform) uses this to avoid collisions
due to multi-threading.</p>
<p><a class="reference external" href="https://stackoverflow.com/a/36944992/11052174">https://stackoverflow.com/a/36944992/11052174</a></p>
</dd></dl>

</div>
<div class="section" id="module-pyvvo.zip">
<span id="zip-py"></span><h2>zip.py<a class="headerlink" href="#module-pyvvo.zip" title="Permalink to this headline">¶</a></h2>
<p>Code for creating ZIP load models. Note that this module follows Python
conventions: functions which start with an underscore are “private.” So,
a user of this module should only use methods which do not start with an
underscore. At the time of writing (2020-06-17), the public methods are:</p>
<blockquote>
<div><ul class="simple">
<li><p>cluster_and_fit</p></li>
<li><p>get_best_fit_from_clustering</p></li>
<li><p>zip_fit</p></li>
</ul>
</div></blockquote>
<p>A discussion of load modeling in PyVVO can be found in <a class="reference external" href="http://hdl.handle.net/10125/64115">this paper</a>.</p>
<p>Discussion of the ZIP modeling follows:</p>
<p>ZIP load models represent a load as part constant impedance (Z), part
constant current (I) and part constant power (P).</p>
<p>Since PyVVO uses GridLAB-D, we’ll be formulating the problem the same
way GridLAB-D does.</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}P_k \! = \! S_n \! \bigg[\! \frac{V_k^2}{V_n^2} Z_\% \cos(Z_\theta) + \frac{V_k}{V_n} I_\% \cos(I_\theta) + P_\%  \cos(P_\theta) \bigg]\\Q_k \! = \! S_n \! \bigg[\! \frac{V_k^2}{V_n^2} Z_\%  \sin(Z_\theta) + \frac{V_k}{V_n}  I_\% \sin(I_\theta) + P_\% \sin(P_\theta) \bigg]\\1 = Z_\% + I_\% + P_\%\end{aligned}\end{align} \]</div>
<p>Where:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(P_k\)</span>: Predicted real power for time/interval <span class="math notranslate nohighlight">\(k\)</span></p>
<p><span class="math notranslate nohighlight">\(Q_k\)</span>: Predicted reactive power for time/interval <span class="math notranslate nohighlight">\(k\)</span></p>
<p><span class="math notranslate nohighlight">\(S_n\)</span>: Magnitude of nominal power</p>
<p><span class="math notranslate nohighlight">\(V_k\)</span>: Magnitude of input voltage for time/interval <span class="math notranslate nohighlight">\(k\)</span></p>
<p><span class="math notranslate nohighlight">\(V_n\)</span>: Nominal voltage</p>
<p><span class="math notranslate nohighlight">\(Z\%\)</span>: Impedance fraction</p>
<p><span class="math notranslate nohighlight">\(Z_\theta\)</span>: Impedance angle</p>
<p><span class="math notranslate nohighlight">\(I\%\)</span>: Current fraction</p>
<p><span class="math notranslate nohighlight">\(I_\theta\)</span>: Current angle</p>
<p><span class="math notranslate nohighlight">\(P\%\)</span>: Power fraction</p>
<p><span class="math notranslate nohighlight">\(P_\theta\)</span>: Power angle</p>
</div></blockquote>
<p>To reduce computations during optimization, we’ll make the following
variable substitutions:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\bar{P}:=\frac{P_k}{S_n}\\\bar{Q}:=\frac{Q_k}{S_n}\\\bar{V}:=\frac{V_a}{V_n}\end{aligned}\end{align} \]</div>
<p>In this module, a “zip_terms” parameter will be used frequently. This
parameter is a numpy array with six entries in the following order:</p>
<p><span class="math notranslate nohighlight">\(Z\%\)</span>, <span class="math notranslate nohighlight">\(Z_\theta\)</span>, <span class="math notranslate nohighlight">\(I\%\)</span>, <span class="math notranslate nohighlight">\(I_\theta\)</span>,
<span class="math notranslate nohighlight">\(P\%\)</span>, <span class="math notranslate nohighlight">\(P_\theta\)</span>.</p>
<dl class="py function">
<dt id="pyvvo.zip.cluster_and_fit">
<code class="sig-prename descclassname">pyvvo.zip.</code><code class="sig-name descname">cluster_and_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">zip_fit_inputs</span></em>, <em class="sig-param"><span class="n">selection_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_clusters</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">min_cluster_size</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.zip.cluster_and_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Cluster data and perform ZIP fit.</p>
<p>Note that voltage will not be included in clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – pandas DataFrame containing all data needed to cluster
(optional) and fit data. At the minimum, columns must
include v (voltage magnitude), p (active power), and q
(reactive power).</p></li>
<li><p><strong>zip_fit_inputs</strong> – dictionary of key word arguments to be passed
to the function zip_fit.</p></li>
<li><p><strong>selection_data</strong> – pandas Series with data to be used for
cluster selection. Index can only contain
labels that exist in data. NOTE:
selection_data should not have ‘v’ in it.
Optional. If None, no clustering is
performed.</p></li>
<li><p><strong>n_clusters</strong> – Integer of clusters to create for clustering.
Optional. Only required if selection_data is not
None.</p></li>
<li><p><strong>min_cluster_size</strong> – Minimum allowed number of data points in
the selected cluster. Optional. Only
required if selection_data is not None.</p></li>
<li><p><strong>random_state</strong> – Integer, numpy.random RandomState object
(preferred) or None. Used for random seeding of
K-Means clustering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>fit_outputs: outputs from ZIP fit plus a ‘data_len’ field,
or None. None will be returned if we’re clustering and the
min_cluster_size requirement is not met. The ‘data_len’ field
indicates the length/height of the data which went into fitting.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.zip.get_best_fit_from_clustering">
<code class="sig-prename descclassname">pyvvo.zip.</code><code class="sig-name descname">get_best_fit_from_clustering</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">zip_fit_inputs</span></em>, <em class="sig-param"><span class="n">selection_data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_cluster_size</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.zip.get_best_fit_from_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop over different numbers of clusters to find the best ZIP fit.</p>
<p>For input descriptions, see <code class="docutils literal notranslate"><span class="pre">cluster_and_fit</span></code> function.</p>
<p>This calls cluster_and_fit function for each loop iteration.</p>
<p>NOTE: the ‘fit_data’ field of zip_fit_inputs will be overridden to
be true, as this function won’t work otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>best_fit. ‘Best’ output (smallest normalized mse_p
+ mse_q) from calling cluster_and_fit. It will also have a ‘k’
field added, indicating the number of clusters used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyvvo.zip.zip_fit">
<code class="sig-prename descclassname">pyvvo.zip.</code><code class="sig-name descname">zip_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vpq</span></em>, <em class="sig-param"><span class="n">v_n</span><span class="o">=</span><span class="default_value">240</span></em>, <em class="sig-param"><span class="n">s_n</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">par_0</span><span class="o">=</span><span class="default_value">0.3333333333333333, 0.5235987755982988, 0.3333333333333333, 0.5235987755982988, 0.3333333333333333, 0.5235987755982988</span></em>, <em class="sig-param"><span class="n">f_tol</span><span class="o">=</span><span class="default_value">1e-06</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">fit_data</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyvvo.zip.zip_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Given V, P, and Q data, perform ZIP fit and get coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vpq</strong> – pandas DataFrame with columns ‘v’ for voltage
magnitude, ‘p’ for real power, and ‘q’ for reactive power.</p></li>
<li><p><strong>v_n</strong> – nominal voltage magnitude.</p></li>
<li><p><strong>s_n</strong> – nominal apparent power magnitude. If None, it will be
estimated/inferred from the vpq data.</p></li>
<li><p><strong>par_0</strong> – Initial guess/starting point for optimization. Should
be array in the order Z%, Z_theta, I%, I_theta, P%, P_theta.</p></li>
<li><p><strong>f_tol</strong> – Precision goal for optimization. Terminates after
change between iterations is &lt; f_tol</p></li>
<li><p><strong>max_iter</strong> – Maximum number of iterations for optimization.</p></li>
<li><p><strong>fit_data</strong> – Boolean flag. If true, include fitted p and q along
with the corresponding mean square error.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>dictionary with several fields:</p>
<ul class="simple">
<li><p>zip_gld:  Dictionary with all the terms needed for GridLAB-D
modeling. These include:</p>
<ul>
<li><p>base_power: S_n</p></li>
<li><p>impedance_fraction: Z%</p></li>
<li><p>impedance_pf: Impedance “power factor,” cos(Z_theta).
Will be negative if the power factor is leading for
GridLAB-D conventions</p></li>
<li><p>current_fraction: I%</p></li>
<li><p>current_pf: Current “power factor,” cos(I_theta).
Negative if leading pf.</p></li>
<li><p>power_fraction: P%</p></li>
<li><p>power_pf: Power “power factor,” cos(P_theta). Negative
if leading pf.</p></li>
</ul>
</li>
<li><p>sol: scipy.optimize.OptimizeResult object from performing
the ZIP fit (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.OptimizeResult.html#scipy.optimize.OptimizeResult">docs</a>).
Fields of note include ‘x’ (contains the zip_terms),
‘success’ (indicating if the optimizer exited successfully),
and ‘message’ (description of the cause of optimizer
termination).</p></li>
</ul>
<p>If fit_data is true, the following fields will be included:</p>
<ul class="simple">
<li><p>p_pred: numpy array of predicted real power for the
resultant ZIP model.</p></li>
<li><p>q_pred: numpy array of predicted reactive power for the
resultant ZIP model.</p></li>
<li><p>mse_p: mean-squared error for real power.</p></li>
<li><p>mse_q: mean-squared error for reactive power.</p></li>
</ul>
<p><strong>IMPORTANT NOTE</strong>: If the optimization fails, the only field
in the return will be ‘sol.’ So it’s up to the caller to either
explicitly check sol.success or handle missing fields.</p>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyVVO</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="build_docs.html">Building the PyVVO Documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PyVVO Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo">pyvvo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.app">app.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.cluster">cluster.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.db">db.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.equipment">equipment.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.ga">ga.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.glm">glm.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.gridappsd_platform">gridappsd_platform.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.load_model">load_model.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.run_pyvvo">run_pyvvo.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.sparql">sparql.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.timeseries">timeseries.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.utils">utils.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyvvo.zip">zip.py</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="build_docs.html" title="previous chapter">Building the PyVVO Documentation</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Pacific Northwest National Laboratory and Brandon Thayer.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/pyvvo_code.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>